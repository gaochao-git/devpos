(this.webpackJsonpreact_front=this.webpackJsonpreact_front||[]).push([[0],{209:function(e,t,a){e.exports=a(418)},214:function(e,t,a){},41:function(e,t,a){},418:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),l=a(6),r=a.n(l),i=(a(214),a(18)),c=a(19),o=a(21),u=a(20),d=a(22),_=a(5),m=a.n(_),p=a(420),h=a(151),f=a(32),b=a(10),g=a(15),E=(a(37),a(58)),y=a(4),v=a.n(y),k=a(204),w=a(150),S=a(421),q=a(425),x=a(77),C=a(45),I=a(426),N=(a(41),"http://39.97.247.142:8000/api"),O=null;function D(){var e,t;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!window.localStorage.getItem("token")){a.next=9;break}return e={token:window.localStorage.getItem("token")},a.next=4,v.a.awrap(m.a.post("".concat(N,"/get_login_user_name_by_token/"),{params:e}).catch((function(e){console.log(e)})));case 4:if("\u9a8c\u8bc1\u6210\u529f"!==(t=a.sent).data.message){a.next=9;break}return a.next=8,v.a.awrap(t.data);case 8:O=a.sent;case 9:return console.log(O),a.abrupt("return",O);case 11:case"end":return a.stop()}}))}m.a.defaults.withCredentials=!0,m.a.defaults.headers.post["Content-Type"]="application/json";var j=k.a.Search,L=w.a.TabPane,V=S.a.Column;function M(e){console.log(e)}var U=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={cluster_info:[]},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.GetClusterInfo()}},{key:"GetClusterInfo",value:function(){var e;return v.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a.awrap(m.a.get("".concat(N,"/get_mysql_cluster_info/")));case 2:e=t.sent,console.log(e.data),console.log(window&&window.location&&window.location.hostname),this.setState({cluster_info:e.data.data});case 6:case"end":return t.stop()}}),null,this)}},{key:"GetSearchClusterInfo",value:function(e){var t;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return this.setState({cluster_info:[]}),a.next=3,v.a.awrap(m.a.post("".concat(N,"/get_search_mysql_cluster_info/"),{cluster_name:e}));case 3:t=a.sent,console.log(t.data),this.setState({cluster_info:t.data.data});case 6:case"end":return a.stop()}}),null,this)}},{key:"render",value:function(){var e=this,t=this.state.cluster_info,a={},n=[{title:"\u96c6\u7fa4\u540d",dataIndex:"cluster_name",key:"cluster_name",render:function(e,n){var s={children:e,props:{}};return s.props.rowSpan=function(e,t,n){var s=0;return e!==a[n]&&(a[n]=e,t.forEach((function(e){e.cluster_name===a[n]&&(s+=1)}))),s}(n.cluster_name,t,"cluster_name"),s}},{title:"\u96c6\u7fa4\u7c7b\u578b",dataIndex:"cluster_type"},{title:"\u4e3b\u673a\u540d",dataIndex:"host_name"},{title:"\u5b9e\u4f8b\u540d",colSpan:1,dataIndex:"instance_name"},{title:"\u5b9e\u4f8b\u72b6\u6001",dataIndex:"instance_status",render:function(e){return s.a.createElement("span",null,"\u6b63\u5e38\u670d\u52a1"===e?s.a.createElement(q.a,{status:"success"}):s.a.createElement(q.a,{status:"error"}),e)}},{title:"read_only",dataIndex:"read_only"},{title:"\u7248\u672c",dataIndex:"version"},{title:"\u5b57\u7b26\u96c6",dataIndex:"server_charset"},{title:"master_ip",dataIndex:"master_ip"},{title:"master_port",dataIndex:"master_port"}];return s.a.createElement("div",{className:"server-list"},s.a.createElement("div",{className:"sub-title"},s.a.createElement("div",null,s.a.createElement(g.b,{className:"title-text",to:"/"},"Home"),">>",s.a.createElement(g.b,{className:"title-text",to:"/mysqlCluster"},"\u96c6\u7fa4\u4fe1\u606f")),s.a.createElement("div",null,s.a.createElement(j,{placeholder:"\u96c6\u7fa4\u540d",onSearch:function(t){return e.GetSearchClusterInfo(t)},style:{width:200},allowClear:!0}))),s.a.createElement(S.a,{dataSource:this.state.cluster_info,columns:n,bordered:!0,size:"small"}),s.a.createElement(w.a,{defaultActiveKey:"1",onChange:M},s.a.createElement(L,{tab:"\u8bca\u65ad",key:"1"},s.a.createElement("div",{className:"site-card-wrapper"},s.a.createElement(x.a,{gutter:16},s.a.createElement(C.a,{span:24},s.a.createElement(I.a,{title:"\u4e3b\u673a\u8bca\u65ad",bordered:!1,size:"small"},s.a.createElement(S.a,{dataSource:[{key:"1",hostname:"l-fbdb1.dba.cn1",disk_avaliable:32,disk_io:.7,cpu:.7,load:23,net_interface_in:400,net_interface_out:400},{key:"2",hostname:"l-fbdb2.dba.cn1",disk_avaliable:32,disk_io:.7,cpu:.7,load:23,net_interface_in:400,net_interface_out:400},{key:"3",hostname:"l-fbdb3.dba.cn1",disk_avaliable:32,disk_io:.7,cpu:.7,load:23,net_interface_in:400,net_interface_out:400}],rowKey:function(e,t){return t},pagination:!1,size:"small",bordered:!0},s.a.createElement(V,{title:"\u4e3b\u673a\u540d",dataIndex:"hostname"}),s.a.createElement(V,{title:"\u78c1\u76d8\u5269\u4f59\u7a7a\u95f4(M)",dataIndex:"disk_avaliable"}),s.a.createElement(V,{title:"\u78c1\u76d8io(%util)",dataIndex:"disk_io"}),s.a.createElement(V,{title:"Cpu(%)",dataIndex:"cpu"}),s.a.createElement(V,{title:"load",dataIndex:"load"}),s.a.createElement(V,{title:"\u7f51\u5361\u6d41\u91cf\u5165(Mib)",dataIndex:"net_interface_in"}),s.a.createElement(V,{title:"\u7f51\u5361\u6d41\u91cf\u51fa(Mib)",dataIndex:"net_interface_out"}))))),s.a.createElement(x.a,{gutter:16},s.a.createElement(C.a,{span:24},s.a.createElement(I.a,{title:"MySQL\u901a\u7528\u8bca\u65ad",bordered:!1,size:"small"},s.a.createElement(S.a,{dataSource:[{key:"1",hostname:"l-fbdb1.dba.cn1",port:3320,instance_name:"10.88.74.185_3320",is_alive:"Yes",current_running_sql_count:24,current_connected_user_ratio:.1,hold_global_lock:"NO",hold_meta_lock:"NO"},{key:"2",hostname:"l-fbdb2.dba.cn1",port:3320,instance_name:"10.88.74.185_3320",is_alive:"Yes",current_running_sql_count:3,current_connected_user_ratio:.5,hold_global_lock:"NO",hold_meta_lock:"NO"},{key:"3",hostname:"l-fbdb3.dba.cn1",port:3320,instance_name:"10.88.74.185_3320",is_alive:"Yes",current_running_sql_count:8,current_connected_user_ratio:.95,hold_global_lock:"NO",hold_meta_lock:"NO"}],rowKey:function(e,t){return t},pagination:!1,size:"small",bordered:!0},s.a.createElement(V,{title:"\u5b9e\u4f8b\u540d",dataIndex:"instance_name"}),s.a.createElement(V,{title:"\u662f\u5426\u8fd0\u884c",dataIndex:"is_alive"}),s.a.createElement(V,{title:"\u8fd0\u884csql\u6570\u91cf",render:function(t){return s.a.createElement("div",null,t.current_running_sql_count>=24?s.a.createElement("span",{className:"row-detail-error"},t.current_running_sql_count):s.a.createElement("span",null,t.current_running_sql_count),s.a.createElement(f.a,{className:"link-button",style:{marginLeft:15},onClick:function(){e.viewRunningSqlByInstanceName(t.instance_name)}},"\u67e5\u770b\u8be6\u60c5"))}}),s.a.createElement(V,{title:"\u5f53\u524d\u8fde\u63a5\u6570/\u6700\u5927\u8fde\u63a5\u6570(%)",render:function(t){return s.a.createElement("div",null,t.current_connected_user_ratio>=.95?s.a.createElement("span",{className:"row-detail-error"},100*t.current_connected_user_ratio):s.a.createElement("span",null,100*t.current_connected_user_ratio),s.a.createElement(f.a,{className:"link-button",style:{marginLeft:15},onClick:function(){e.viewConnectedUserByInstanceName(t.instance_name)}},"\u67e5\u770b\u8be6\u60c5"),s.a.createElement(f.a,{className:"link-button",style:{marginLeft:15},onClick:function(){e.viewConnectedUserByInstanceName(t.instance_name)}},"\u66f4\u6539\u8fde\u63a5\u6570"))}}),s.a.createElement(V,{title:"\u5168\u5c40\u9501",dataIndex:"hold_global_lock"}),s.a.createElement(V,{title:"\u5143\u6570\u636e\u9501",dataIndex:"hold_meta_lock"}))))),s.a.createElement(x.a,{gutter:16},s.a.createElement(C.a,{span:13},s.a.createElement(I.a,{title:"galera\u8bca\u65ad",bordered:!1,size:"small"},s.a.createElement(S.a,{dataSource:[{key:"1",hostname:"l-fbdb1.dba.cn1",instance_name:"10.88.74.185_3320",port:3320,wsrep_cluster_name:"gaochao_test_wsrep_cluster",wsrep_cluster_size:3,wsrep_local_state_comment:"Synced",wsrep_connected:"ON",wsrep_ready:"ON"},{key:"2",hostname:"l-fbdb2.dba.cn1",instance_name:"10.88.74.185_3320",port:3320,wsrep_cluster_name:"gaochao_test_wsrep_cluster",wsrep_cluster_size:3,wsrep_local_state_comment:"Synced",wsrep_connected:"ON",wsrep_ready:"ON"},{key:"3",hostname:"l-fbdb3.dba.cn1",instance_name:"10.88.74.185_3320",port:3320,namespace:"gaochao_test_wsrep_cluster",wsrep_cluster_size:3,wsrep_local_state_comment:"Synced",wsrep_connected:"ON",wsrep_ready:"ON"}],rowKey:function(e,t){return t},pagination:!1,size:"small",bordered:!0},s.a.createElement(V,{title:"\u5b9e\u4f8b\u540d",dataIndex:"instance_name"}),s.a.createElement(V,{title:"wsrep_local_state_comment",dataIndex:"wsrep_local_state_comment"}),s.a.createElement(V,{title:"wsrep_connected",dataIndex:"wsrep_connected"}),s.a.createElement(V,{title:"wsrep_ready",dataIndex:"wsrep_ready"})))),s.a.createElement(C.a,{span:11},s.a.createElement(I.a,{title:"replication\u8bca\u65ad",bordered:!1,size:"small"},s.a.createElement(S.a,{dataSource:[{key:"1",hostname:"l-fbdb1.dba.cn1",instance_name:"10.88.74.185_3320",port:3320,io_thread:"Yes",sql_thread:"Yes",seconds_behind_master:0},{key:"2",hostname:"l-fbdb2.dba.cn1",port:3320,instance_name:"10.88.74.185_3320",io_thread:"Yes",sql_thread:"Yes",seconds_behind_master:0},{key:"3",hostname:"l-fbdb3.dba.cn1",port:3320,instance_name:"10.88.74.185_3320",io_thread:"Yes",sql_thread:"Yes",seconds_behind_master:0}],rowKey:function(e,t){return t},pagination:!1,size:"small",bordered:!0},s.a.createElement(V,{title:"\u5b9e\u4f8b\u540d",dataIndex:"instance_name"}),s.a.createElement(V,{title:"io_thread",dataIndex:"io_thread"}),s.a.createElement(V,{title:"sql_thread",dataIndex:"sql_thread"}),s.a.createElement(V,{title:"delay(s)",dataIndex:"seconds_behind_master"}))))),s.a.createElement(x.a,{gutter:16},s.a.createElement(C.a,{span:24},s.a.createElement(I.a,{title:"\u6162\u67e5\u8be2\u65e5\u5fd7\u8bca\u65ad(\u6700\u8fd1600s)",bordered:!1,size:"small"},s.a.createElement(S.a,{dataSource:[{key:"1",hostname:"l-fbdb1.dba.cn1",instance_name:"10.88.74.185_3320",port:3320,lock_time_sql_count:30,rows_sent_sql_count:10,rows_examined_sql_count:100,rows_affected_sql_count:100},{key:"2",hostname:"l-fbdb2.dba.cn1",instance_name:"10.88.74.185_3320",port:3320,lock_time_sql_count:30,rows_sent_sql_count:10,rows_examined_sql_count:100,rows_affected_sql_count:100},{key:"3",hostname:"l-fbdb3.dba.cn1",instance_name:"10.88.74.185_3320",port:3320,lock_time_sql_count:30,rows_sent_sql_count:10,rows_examined_sql_count:100,rows_affected_sql_count:100}],rowKey:function(e,t){return t},pagination:!1,size:"small",bordered:!0},s.a.createElement(V,{title:"\u5b9e\u4f8b\u540d",dataIndex:"instance_name"}),s.a.createElement(V,{title:"Lock_time\u5f02\u5e38sql\u6570\u91cf(>1s)",render:function(t){return s.a.createElement("div",null,t.lock_time_sql_count>=24?s.a.createElement("span",{className:"row-detail-error"},t.lock_time_sql_count):s.a.createElement("span",null,t.lock_time_sql_count),s.a.createElement(f.a,{className:"link-button",style:{marginLeft:15},onClick:function(){e.viewRunningSqlByInstanceName(t.lock_time_sql_count)}},"\u67e5\u770b\u8be6\u60c5"))}}),s.a.createElement(V,{title:"Rows_sent\u5f02\u5e38sql\u6570\u91cf(>1\u4e07)",render:function(t){return s.a.createElement("div",null,t.rows_sent_sql_count>=24?s.a.createElement("span",{className:"row-detail-error"},t.rows_sent_sql_count):s.a.createElement("span",null,t.rows_sent_sql_count),s.a.createElement(f.a,{className:"link-button",style:{marginLeft:15},onClick:function(){e.viewRunningSqlByInstanceName(t.rows_sent_sql_count)}},"\u67e5\u770b\u8be6\u60c5"))}}),s.a.createElement(V,{title:"Rows_examined\u5f02\u5e38SQL\u6570\u91cf(>1\u4e07)",render:function(t){return s.a.createElement("div",null,t.rows_examined_sql_count>=24?s.a.createElement("span",{className:"row-detail-error"},t.rows_examined_sql_count):s.a.createElement("span",null,t.rows_examined_sql_count),s.a.createElement(f.a,{className:"link-button",style:{marginLeft:15},onClick:function(){e.viewRunningSqlByInstanceName(t.rows_examined_sql_count)}},"\u67e5\u770b\u8be6\u60c5"))}}),s.a.createElement(V,{title:"Rows_affected\u5f02\u5e38SQL\u6570\u91cf(>1\u4e07)",render:function(t){return s.a.createElement("div",null,t.rows_affected_sql_count>=24?s.a.createElement("span",{className:"row-detail-error"},t.rows_affected_sql_count):s.a.createElement("span",null,t.rows_affected_sql_count),s.a.createElement(f.a,{className:"link-button",style:{marginLeft:15},onClick:function(){e.viewRunningSqlByInstanceName(t.rows_affected_sql_count)}},"\u67e5\u770b\u8be6\u60c5"))}}))))),s.a.createElement(x.a,{gutter:16},s.a.createElement(C.a,{span:24},s.a.createElement(I.a,{title:"\u9519\u8bef\u65e5\u5fd7\u8bca\u65ad(\u6700\u8fd1600s)",bordered:!1,size:"small"},s.a.createElement(S.a,{dataSource:[{key:"1",hostname:"l-fbdb1.dba.cn1",instance_name:"10.88.74.185_3320",port:3320,error_log_info:"dead lock"},{key:"2",hostname:"l-fbdb2.dba.cn1",instance_name:"10.88.74.185_3320",port:3320,error_log_info:"dead lock"},{key:"3",hostname:"l-fbdb3.dba.cn1",instance_name:"10.88.74.185_3320",port:3320,error_log_info:"dead lock"}],rowKey:function(e,t){return t},pagination:!1,size:"small",bordered:!0},s.a.createElement(V,{title:"\u5b9e\u4f8b\u540d",dataIndex:"instance_name"}),s.a.createElement(V,{title:"\u9519\u8bef\u65e5\u5fd7\u4fe1\u606f",dataIndex:"error_log_info"}))))))),s.a.createElement(L,{tab:"Tab 2",key:"2"},"Content of Tab Pane 2"),s.a.createElement(L,{tab:"Tab 3",key:"3"},"Content of Tab Pane 3")))}}]),t}(n.Component),B=a(422),T=a(57),A=a(424),P=a(113),G=a(427),Q=a(423);m.a.defaults.withCredentials=!0,m.a.defaults.headers.post["Content-Type"]="application/json";var z=k.a.TextArea,H=w.a.TabPane,K=S.a.Column,R=B.a.Item,F=T.a.Option,Y=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields((function(e,t){console.log("Received values of form: ",t,a.state.check_sql_results),t.check_sql_results=a.state.check_sql_results,"\u672a\u63d0\u4ea4"===a.state.submit_sql_flag?a.handleSqlSubmit(t):A.a.error(a.state.submit_sql_flag)}))},a.onSearch=function(e){a.handleGetMasterIp(e)},a.onClusterNameSearch=function(e){a.handleGetClusterName(e)},a.onSelect=function(e){a.setState({des_ip:e})},a.onClusterNameSelect=function(e){a.setState({cluster_name:e})},a.handleHostPortChange=function(e){a.setState({des_port:e})},a.handleClusterNameChange=function(e){a.setState({cluster_name:e})},a.handleSqlChange=function(e){a.setState({check_sql:e,check_sql_results:[]})},a.showDataModalHandle=function(e){0===a.state.check_sql.length||0===a.state.check_sql_results.length?A.a.error("\u63d0\u4ea4\u6240\u9700\u53c2\u6570\u4e0d\u6ee1\u8db3\u8981\u6c42"):a.setState({showDataVisible:!0})},a.showDataHandleCancel=function(e){a.setState({showDataVisible:!1})},a.handleDbSourceTypeChange=function(e){a.setState({submit_source_db_type:e})},a.handleReset=function(){a.props.form.resetFields()},a.toggle=function(){var e=a.state.expand;a.setState({expand:!e})},a.state={expand:!1,selectEnvOptionData:["\u751f\u4ea7","\u6d4b\u8bd5"],selectExecuteTypeOptionData:["\u7acb\u5373\u6267\u884c","\u6682\u7f13\u6267\u884c"],des_ip:"",des_port:"",check_sql:"",check_sql_info:[],check_sql_results:[],showDataVisible:!1,submit_sql_info:[],submit_sql_button_disabled:"hide",submit_sql_flag:"\u672a\u63d0\u4ea4",sql_check_loading:!1,sql_submit_loading:!1,des_ip_list:[],cluster_name_list:[],submit_source_db_type:"cluster",cluster_name:"",schema_name:"",table_name:"",min_id:"",max_id:"",where_condition:"",mdl_type:"delete",create_sql_content:"",rebuild_table:"",set_value:""},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.GetSubmitSqlInfo()}},{key:"GetSubmitSqlInfo",value:function(){var e;return v.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a.awrap(m.a.get("".concat(N,"/get_submit_sql_info/")));case 2:e=t.sent,this.setState({submit_sql_info:e.data.data});case 4:case"end":return t.stop()}}),null,this)}},{key:"handleSqlCheck",value:function(){return v.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:"cluster"===this.state.submit_source_db_type?this.handleClusterNameSqlCheck():this.handleMasterIpPortSqlCheck();case 1:case"end":return e.stop()}}),null,this)}},{key:"handlerCreateBlockSql",value:function(){var e,t=this;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return this.setState({create_sql_content:""}),e={db_ip:this.state.des_ip,db_port:this.state.des_port,cluster_name:this.state.cluster_name,schema_name:this.state.schema_name,table_name:this.state.table_name,min_id:this.state.min_id,max_id:this.state.max_id,where_condition:this.state.where_condition,mdl_type:this.state.mdl_type,rebuild_table:this.state.rebuild_table,set_value:this.state.set_value},console.log(e),a.next=5,v.a.awrap(m.a.post("".concat(N,"/create_block_sql/"),{params:e}).then((function(e){"ok"===e.data.status?t.setState({create_sql_content:e.data.data}):A.a.error(e.data.message,3)&&t.setState({create_sql_content:""})})).catch((function(e){A.a.error(e,3),t.setState({create_sql_content:""})})));case 5:case"end":return a.stop()}}),null,this)}},{key:"handleClusterNameSqlCheck",value:function(){var e,t=this;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(0!==this.state.cluster_name.length&&0!==this.state.check_sql.length){a.next=4;break}A.a.error("\u8f93\u5165\u6846\u4e0d\u80fd\u4e3a\u7a7a"),a.next=8;break;case 4:return e={db_ip:this.state.des_ip,db_port:this.state.des_port,check_sql_info:this.state.check_sql,cluster_name:this.state.cluster_name,submit_source_db_type:this.state.submit_source_db_type},this.setState({check_sql_results:[],sql_check_loading:!0,submit_sql_button_disabled:"hide"}),a.next=8,v.a.awrap(m.a.post("".concat(N,"/check_sql/"),{params:e}).then((function(e){"ok"===e.data.status?t.setState({check_sql_results:e.data.data,submit_sql_button_disabled:"show",sql_check_loading:!1}):A.a.error(e.data.message,3)&&t.setState({check_sql_results:[],sql_check_loading:!1})})).catch((function(e){A.a.error(e,3),t.setState({check_sql_results:[],sql_check_loading:!1})})));case 8:case"end":return a.stop()}}),null,this)}},{key:"handleMasterIpPortSqlCheck",value:function(){var e,t=this;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(0!==this.state.des_ip.length&&0!==this.state.des_port.length&&0!==this.state.check_sql.length){a.next=4;break}A.a.error("\u8f93\u5165\u6846\u4e0d\u80fd\u4e3a\u7a7a"),a.next=8;break;case 4:return e={db_ip:this.state.des_ip,db_port:this.state.des_port,check_sql_info:this.state.check_sql,cluster_name:this.state.cluster_name,submit_source_db_type:this.state.submit_source_db_type},this.setState({check_sql_results:[],sql_check_loading:!0,submit_sql_button_disabled:"hide"}),a.next=8,v.a.awrap(m.a.post("".concat(N,"/check_sql/"),{params:e}).then((function(e){"ok"===e.data.status?t.setState({check_sql_results:e.data.data,submit_sql_button_disabled:"show",sql_check_loading:!1}):A.a.error(e.data.message,3)&&t.setState({check_sql_results:[],sql_check_loading:!1})})).catch((function(e){A.a.error(e,3),t.setState({check_sql_results:[],sql_check_loading:!1})})));case 8:case"end":return a.stop()}}),null,this)}},{key:"handleSqlSubmit",value:function(e){var t,a;return v.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return this.setState({sql_submit_loading:!0}),t={submit_source_db_type:this.state.submit_source_db_type,cluster_name:this.state.cluster_name,db_ip:this.state.des_ip,db_port:this.state.des_port,check_sql:this.state.check_sql,title:e.Title,env:e.ENV,info:e.INFO,check_sql_results:e.check_sql_results,submit_sql_execute_type:e["\u6267\u884c\u7c7b\u578b"],comment_info:e.comment_info},n.next=4,v.a.awrap(m.a.post("".concat(N,"/submit_sql/"),{params:t}));case 4:"ok"===(a=n.sent).data.status?window.location.reload():alert(a.data.message);case 6:case"end":return n.stop()}}),null,this)}},{key:"handleGetMasterIp",value:function(e){var t,a;return v.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(e.length>=1)){n.next=8;break}return t={db_master_ip_or_hostname:e},n.next=4,v.a.awrap(m.a.post("".concat(N,"/get_master_ip/"),{params:t}));case 4:"ok"===(a=n.sent).data.status?this.setState({des_ip_list:0===a.data.data.length?[]:a.data.data}):console.log("get_master_ip\u63a5\u53e3\u9519\u8bef"),n.next=9;break;case 8:this.setState({des_ip_list:[]});case 9:case"end":return n.stop()}}),null,this)}},{key:"handleGetClusterName",value:function(e){var t,a;return v.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(e.length>=1)){n.next=8;break}return t={cluster_name:e},n.next=4,v.a.awrap(m.a.post("".concat(N,"/get_cluster_name/"),{params:t}));case 4:"ok"===(a=n.sent).data.status?this.setState({cluster_name_list:0===a.data.data.length?[]:a.data.data}):console.log("get_cluster_name\u63a5\u53e3\u9519\u8bef"),n.next=9;break;case 8:this.setState({cluster_name_list:[]});case 9:case"end":return n.stop()}}),null,this)}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator;return s.a.createElement(w.a,{className:"container"},s.a.createElement(H,{tab:"SQL\u5de5\u5355\u5217\u8868",key:"1"},s.a.createElement(S.a,{dataSource:this.state.submit_sql_info,rowKey:function(e,t){return t},size:"small"},s.a.createElement(K,{title:"\u6807\u9898",dataIndex:"title",render:function(e){return e.length>5?s.a.createElement(P.a,{placement:"topLeft",title:e},s.a.createElement("span",null,e.slice(0,5),"...")):s.a.createElement("span",null,e)}}),s.a.createElement(K,{title:"\u7533\u8bf7\u4eba",dataIndex:"submit_sql_user"}),s.a.createElement(K,{title:"TL",dataIndex:"leader_user_name"}),s.a.createElement(K,{title:"QA",dataIndex:"qa_user_name"}),s.a.createElement(K,{title:"TL\u5ba1\u6838",dataIndex:"leader_check",render:function(e){return s.a.createElement("span",null,"\u901a\u8fc7"===e?s.a.createElement("span",{style:{color:"green"}},e):s.a.createElement("span",{style:{color:"red"}},e))}}),s.a.createElement(K,{title:"QA\u5ba1\u6838",dataIndex:"qa_check",render:function(e){return s.a.createElement("span",null,"\u901a\u8fc7"===e?s.a.createElement("span",{style:{color:"green"}},e):s.a.createElement("span",{style:{color:"red"}},e))}}),s.a.createElement(K,{title:"DBA\u5ba1\u6838",dataIndex:"dba_check",render:function(e){return s.a.createElement("span",null,"\u901a\u8fc7"===e?s.a.createElement("span",{style:{color:"green"}},e):s.a.createElement("span",{style:{color:"red"}},e))}}),s.a.createElement(K,{title:"DBA\u6267\u884c",dataIndex:"dba_execute",render:function(e){return s.a.createElement("span",null,"\u5df2\u6267\u884c"===e?s.a.createElement("span",{style:{color:"green"}},e):s.a.createElement("span",null,e))}}),s.a.createElement(K,{title:"\u6267\u884c\u4eba\u5458",dataIndex:"dba_execute_user_name"}),s.a.createElement(K,{title:"\u6267\u884c\u7ed3\u679c",dataIndex:"execute_status",render:function(e){return s.a.createElement("span",null,"\u6267\u884c\u6210\u529f"===e||"\u672a\u6267\u884c"===e?s.a.createElement("span",null,e):s.a.createElement("span",{style:{color:"red"}},e))}}),s.a.createElement(K,{title:"\u5de5\u5355\u521b\u5efa\u65f6\u95f4",dataIndex:"ctime"}),s.a.createElement(K,{title:"\u5de5\u5355\u4fee\u6539\u65f6\u95f4",dataIndex:"utime"}),s.a.createElement(K,{title:"\u64cd\u4f5c",render:function(e){return s.a.createElement(g.b,{to:"/viewApplySqlByUuid/".concat(e.submit_sql_uuid)},"\u67e5\u770b")}}))),s.a.createElement(H,{tab:"SQL\u65b0\u5efa\u5de5\u5355",key:"2"},s.a.createElement("div",{className:"sub-title-input"},s.a.createElement(T.a,{defaultValue:"\u96c6\u7fa4\u540d",style:{width:150},onChange:function(t){return e.handleDbSourceTypeChange(t)}},s.a.createElement(F,{value:"cluster"},"\u96c6\u7fa4\u540d"),s.a.createElement(F,{value:"master_ip"},"master_ip_port"),s.a.createElement(F,{value:"template"},"\u6a21\u7248")),"cluster"===this.state.submit_source_db_type?s.a.createElement("div",null,s.a.createElement(G.a,{dataSource:this.state.cluster_name_list,style:{width:300,marginLeft:10},onSelect:this.onClusterNameSelect,onSearch:this.onClusterNameSearch,placeholder:"\u8f93\u5165\u96c6\u7fa4\u540d",size:"default"})):s.a.createElement("div",null,s.a.createElement(G.a,{dataSource:this.state.des_ip_list,style:{width:300,marginLeft:10},onSelect:this.onSelect,onSearch:this.onSearch,placeholder:"\u6570\u636e\u5e93\u4e3b\u5e93\u5730\u5740ip\u6216\u4e3b\u673a\u540d",size:"default"}),s.a.createElement(k.a,{size:"default",style:{marginLeft:10,width:300},placeholder:"\u6570\u636e\u5e93\u7aef\u53e3",onChange:function(t){return e.handleHostPortChange(t.target.value)}}))),s.a.createElement("div",null,s.a.createElement(z,{rows:10,placeholder:"\u8f93\u5165SQL,\u6bcf\u6761SQL\u4ee5 ; \u7ed3\u5c3e",onChange:function(t){return e.handleSqlChange(t.target.value)}}),s.a.createElement(f.a,{type:"primary",loading:this.state.sql_check_loading,onClick:function(){e.handleSqlCheck()}},"\u68c0\u6d4bSQL"),"show"===this.state.submit_sql_button_disabled?s.a.createElement(f.a,{style:{marginLeft:10},type:"primary",onClick:function(){e.showDataModalHandle()}},"\u63d0\u4ea4SQL"):null),s.a.createElement(S.a,{dataSource:this.state.check_sql_results,rowKey:function(e,t){return t},rowClassName:function(e,t){var a="row-detail-default ";return 2===e.Error_Level?a="row-detail-error":0===e.Error_Level?a="row-detail-success":1===e.Error_Level?a="row-detail-warning":a},pagination:!0,size:"small",columns:[{title:"ID",dataIndex:"ID",key:"ID"},{title:"SQL",dataIndex:"SQL",key:"SQL",width:520},{title:"\u72b6\u6001",dataIndex:"Stage_Status",key:"Stage_Status"},{title:"\u9519\u8bef\u4ee3\u7801",dataIndex:"Error_Level",key:"Error_Level",sorter:function(e,t){return e.Error_Level-t.Error_Level}},{title:"\u9519\u8bef\u4fe1\u606f",dataIndex:"Error_Message",key:"Error_Message"},{title:"\u5f71\u54cd\u884c\u6570",dataIndex:"Affected_rows",key:"Affected_rows"}]}),s.a.createElement(Q.a,{title:"\u8868\u5355\u63d0\u4ea4",visible:this.state.showDataVisible,onCancel:this.showDataHandleCancel,onOk:this.handleSqlSubmit.bind(this),width:"960px",footer:!1},s.a.createElement(B.a,{className:"ant-advanced-search-form",labelCol:{span:2},onSubmit:this.handleSubmit},s.a.createElement(x.a,{gutter:24},s.a.createElement(I.a,null,s.a.createElement(R,{label:"Title"},t("Title",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165title"}]})(s.a.createElement(k.a,{placeholder:"\u8bf7\u8f93\u5165title"}))),s.a.createElement(R,{label:"ENV"},t("ENV",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u73af\u5883"}]})(s.a.createElement(T.a,null,this.state.selectEnvOptionData.map((function(e,t){return s.a.createElement(T.a.Option,{key:t,value:e},e)}))))),s.a.createElement(R,{label:"\u6267\u884c\u7c7b\u578b"},t("\u6267\u884c\u7c7b\u578b",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6267\u884c\u7c7b\u578b"}]})(s.a.createElement(T.a,null,this.state.selectExecuteTypeOptionData.map((function(e,t){return s.a.createElement(T.a.Option,{key:t,value:e},e)}))))),s.a.createElement(R,{label:"\u5907\u6ce8"},t("comment_info",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165comment_info"}]})(s.a.createElement(k.a,{placeholder:"\u8bf7\u8f93\u5165\u5907\u6ce8"})))),s.a.createElement(f.a,{type:"primary",loading:this.state.sql_submit_loading,htmlType:"submit"},"submit"))))),s.a.createElement(H,{tab:"\u751f\u6210\u5757SQL",key:"3"},s.a.createElement("div",{className:"sub-title-input"},s.a.createElement(k.a,{size:"default",style:{width:150},placeholder:"\u5e93\u540d",onChange:function(t){return e.setState({schema_name:t.target.value})}}),s.a.createElement(k.a,{size:"default",style:{marginLeft:10,width:300},placeholder:"\u8868\u540d",onChange:function(t){return e.setState({table_name:t.target.value})}})),s.a.createElement("div",{className:"sub-title-input"},s.a.createElement(k.a,{size:"default",style:{width:150},placeholder:"\u6700\u5c0fID",onChange:function(t){return e.setState({min_id:t.target.value})}}),s.a.createElement(k.a,{size:"default",style:{marginLeft:10,width:300},placeholder:"\u6700\u5927ID",onChange:function(t){return e.setState({max_id:t.target.value})}})),s.a.createElement("div",{className:"sub-title-input"},s.a.createElement(T.a,{defaultValue:"delete",style:{width:150},onChange:function(t){return e.setState({mdl_type:t})}},s.a.createElement(F,{value:"delete"},"delete"),s.a.createElement(F,{value:"update"},"update")),"delete"===this.state.mdl_type?s.a.createElement(T.a,{defaultValue:"\u91cd\u5efa\u8868",style:{marginLeft:10,width:150},onChange:function(t){return e.setState({rebuild_table:t})}},s.a.createElement(F,{value:"\u91cd\u5efa\u8868"},"\u91cd\u5efa\u8868"),s.a.createElement(F,{value:"\u4e0d\u91cd\u5efa\u8868"},"\u4e0d\u91cd\u5efa\u8868")):null),s.a.createElement("div",{className:"sub-title-input"},"update"===this.state.mdl_type?s.a.createElement(k.a,{size:"default",style:{width:800},placeholder:"set \u6761\u4ef6(\u4e0d\u8981\u8f93\u5165set\u5173\u952e\u5b57),\u6b63\u786e\u8f93\u5165\u6848\u4f8b:name='\u5f20\u4e09', age=18",onChange:function(t){return e.setState({set_value:t.target.value})}}):null),s.a.createElement("div",{className:"sub-title-input"},s.a.createElement(k.a,{size:"default",style:{width:800},placeholder:"where \u6761\u4ef6(\u4e0d\u8981\u8f93\u5165where\u5173\u952e\u5b57,\u4e0d\u8981\u8f93\u5165\u7ed3\u675f\u7b26),\u6b63\u786e\u8f93\u5165\u6848\u4f8b:name='\u5f20\u4e09' and age=18",onChange:function(t){return e.setState({where_condition:t.target.value})}})),s.a.createElement("div",{className:"sub-title-input"},s.a.createElement(f.a,{type:"primary",loading:this.state.sql_check_loading,onClick:function(){e.handlerCreateBlockSql()}},"\u751f\u6210SQL")),s.a.createElement("div",{className:"sub-title-input"},""===this.state.create_sql_content?null:s.a.createElement(z,{rows:5,value:this.state.create_sql_content,onChange:function(t){return e.setState({where_condition:t.target.value})}})),s.a.createElement("br",null),s.a.createElement("div",null,s.a.createElement("span",{style:{color:"#fa541c"}},"\u529f\u80fd\u8bf4\u660e1\uff1a\u901a\u8fc7\u4e3b\u952eid\u548c\u7528\u6237\u6761\u4ef6\u62c6\u5206\u6210\u591a\u4e2aSQL,\u907f\u514d\u5927\u4e8b\u7269\u5f71\u54cd\u7ebf\u4e0a\u4e1a\u52a1(\u9002\u7528\u4e3b\u952e\u4e3aid\u6574\u578b\u81ea\u589e\u573a\u666f)")),s.a.createElement("div",null,s.a.createElement("span",{style:{color:"#fa541c"}},"\u529f\u80fd\u8bf4\u660e2\uff1a\u91cd\u5efa\u8868\u7528\u6765\u56de\u6536delete\u4ea7\u751f\u7684\u788e\u7247,\u91ca\u653e\u6570\u636e\u6587\u4ef6\u7a7a\u95f4\u53ca\u78c1\u76d8\u7a7a\u95f4"))))}}]),t}(n.Component),W=B.a.create()(Y),J=a(88),$=a(89),X=a(104),Z=a(419),ee=a(75),te=S.a.Column,ae=k.a.TextArea,ne=function(e){var t=e.editable,a=e.value,n=e.onChange;return s.a.createElement("div",null,t?s.a.createElement(k.a,{style:{margin:"-5px 0"},value:a,onChange:function(e){return n(e.target.value)}}):a)},se=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).setInterVal=function(){a.timerId=window.setInterval(a.GetSqlApplyByUuid.bind(Object(X.a)(a)),1e3)},a.inception_varialbes_columns=[{title:"\u53c2\u6570\u540d\u79f0",dataIndex:"name",width:"25%",render:function(e,t){return a.renderColumns(e,t,"name")}},{title:"\u53c2\u6570\u542b\u4e49",dataIndex:"variable_description",width:"45%",render:function(e,t){return a.renderColumns(e,t,"variable_description")}},{title:"\u503c",dataIndex:"value",width:"10%",render:function(e,t){return a.renderColumns(e,t,"value")}},{title:"\u64cd\u4f5c",dataIndex:"operation",render:function(e,t){return s.a.createElement("div",{className:"editable-row-operations"},a.state.editingKey===t.name?s.a.createElement("span",null,s.a.createElement(f.a,{onClick:function(){return a.cancel(t.name)},type:"primary",size:"small"},"\u53d6\u6d88"),s.a.createElement(Z.a,{title:"\u786e\u8ba4\u4fdd\u5b58 ?",onConfirm:function(){return a.save(t.name)},okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},s.a.createElement(f.a,{type:"primary",size:"small",style:{marginLeft:"10px"}},"\u4fdd\u5b58"))):s.a.createElement(f.a,{onClick:function(){return a.edit(t.name)},disabled:!t.editable,type:"primary",size:"small"},"\u4fee\u6539"))}}],a.state={submit_sql_title:"",submit_sql:"",master_ip:"",master_port:"",submit_sql_user:"",leader_user_name:"",qa_user_name:"",dba_check_user_name:"",dba_execute_user_name:"",leader_check:"",qa_check:"",dba_check:"",dba_execute:"",execute_status:"",execute_sql_process_results:[],check_sql_results:[],view_check_sql_result:[],view_submit_sql_info:[],view_submit_split_sql_info:[],submit_sql_uuid:"",showSubmitSqlViewVisible:!1,showSubmitSqlResultsVisible:!1,ApplyModalVisible:!1,ViewExecuteSubmitSqlModalVisible:!1,ViewExecuteSubmitSqlProcessModalVisible:!1,InceptionVariableConfigModalVisible:!1,timerId:null,timerProcessId:null,execute_sql_flag:"",inception_backup:1,inception_check_ignore_warning:0,inception_execute_ignore_error:0,data:[],editingKey:"",newClusterCfg:{},newConfig:{},split_sql_file_path:"",submit_split_sql:"",SplitSQLModalVisible:!1,sql_check_max_code:"",login_user_name:"",login_user_name_role:"",sql_view_loading:!1,sql_check_results_loading:!1,sql_check_pass_loading:!1,sql_check_code_explain:"",cluster_name:"",check_comment:""},a.cacheData=a.state.data.map((function(e){return Object($.a)({},e)})),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.submit_sql_uuid;this.GetSqlApplyByUuid(t),this.GetSqlCheckResultsByUuid(t),D().then((function(t){e.setState({login_user_name:t.data.username,login_user_name_role:t.data.title})})).catch((function(e){console.log(e)}))}},{key:"GetSqlApplyByUuid",value:function(e){var t,a,n;return v.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return t={submit_sql_uuid:this.props.match.params.submit_sql_uuid},"\u6267\u884c\u6210\u529f"===this.state.execute_status||"\u6267\u884c\u5931\u8d25"===this.state.execute_status||"\u6267\u884c\u6210\u529f(\u542b\u8b66\u544a)"===this.state.execute_status?(window.clearInterval(this.timerId),window.clearInterval(this.timerProcessId),console.log("SQL\u6267\u5b8c\u6bd5\uff0c\u5173\u95ed\u5b9a\u65f6\u5668")):(console.log("SQL\u6267\u884c\u4e2d\uff0c\u5b9a\u65f6id\u4e3a:",this.timerId),console.log("SQL\u6267\u884c\u72b6\u6001:",this.state.execute_status)),e.next=4,v.a.awrap(m.a.post("".concat(N,"/get_apply_sql_by_uuid/"),{params:t}));case 4:return a=e.sent,e.next=7,v.a.awrap(m.a.post("".concat(N,"/get_split_sql_by_uuid/"),{params:t}));case 7:n=e.sent,a.data.data[0].cluster_name.length>0?this.setState({cluster_name:a.data.data[0].cluster_name}):this.setState({master_ip:a.data.data[0].master_ip,master_port:a.data.data[0].master_port}),this.setState({submit_sql_title:a.data.data[0].title,submit_sql_user:a.data.data[0].submit_sql_user,leader_user_name:a.data.data[0].leader_user_name,qa_user_name:a.data.data[0].qa_user_name,dba_check_user_name:a.data.data[0].dba_check_user_name,dba_execute_user_name:a.data.data[0].dba_execute_user_name,leader_check:a.data.data[0].leader_check,qa_check:a.data.data[0].qa_check,dba_check:a.data.data[0].dba_check,dba_execute:a.data.data[0].dba_execute,execute_status:a.data.data[0].execute_status,submit_sql_uuid:a.data.data[0].submit_sql_uuid,submit_sql_rows:a.data.data[0].submit_sql_rows,submit_sql_affect_rows:a.data.data[0].submit_sql_affect_rows,submit_sql_execute_type:a.data.data[0].submit_sql_execute_type,comment_info:a.data.data[0].comment_info,view_submit_split_sql_info:n.data.data}),console.log(this.state.view_submit_split_sql_info);case 11:case"end":return e.stop()}}),null,this)}},{key:"GetSubmitSqlByUuid",value:function(e){var t,a;return v.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({sql_view_loading:!0}),t={submit_sql_uuid:this.state.submit_sql_uuid},e.next=4,v.a.awrap(m.a.post("".concat(N,"/get_submit_sql_by_uuid/"),{params:t}));case 4:"ok"===(a=e.sent).data.status?this.setState({showSubmitSqlViewVisible:!0,submit_sql:a.data.data,sql_view_loading:!1}):(A.a.error(a.data.message),this.setState({sql_view_loading:!1}));case 6:case"end":return e.stop()}}),null,this)}},{key:"GetSqlCheckResultsByUuid",value:function(e){var t,a,n,s;return v.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({sql_check_results_loading:!0}),t={submit_sql_uuid:this.props.match.params.submit_sql_uuid},e.next=4,v.a.awrap(m.a.post("".concat(N,"/get_check_sql_results_by_uuid/"),{params:t}));case 4:for(a=e.sent,n=[],s=0;s<a.data.data.length;s++)n.push(a.data.data[s].inception_error_level);this.setState({view_check_sql_result:a.data.data,sql_check_max_code:Math.max.apply(null,n),sql_check_code_explain:0!==Math.max.apply(null,n)?"\u5f02\u5e38":"\u6b63\u5e38",sql_check_results_loading:!1});case 9:case"end":return e.stop()}}),null,this)}},{key:"PassSubmitSqlByUuid",value:function(e){var t,a;return v.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return this.setState({sql_check_pass_loading:!0}),t={submit_sql_uuid:this.state.submit_sql_uuid,apply_results:e,check_user_name:this.state.login_user_name,check_user_name_role:this.state.login_user_name_role,check_comment:this.state.check_comment},n.next=4,v.a.awrap(m.a.post("".concat(N,"/pass_submit_sql_by_uuid/"),{params:t}));case 4:a=n.sent,A.a.success(a.data.message),this.setState({ApplyModalVisible:!1,view_submit_sql_info:a.data.data,sql_check_pass_loading:!1}),this.GetSqlApplyByUuid(this.state.submit_sql_uuid);case 8:case"end":return n.stop()}}),null,this)}},{key:"ExecuteBySplitSqlFilePath",value:function(e){var t,a,n,s,l,r,i=this;return v.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:for(this.setState({execute_status:"\u6267\u884c\u4e2d"}),t={submit_sql_uuid:this.state.submit_sql_uuid,inception_backup:this.state.inception_backup,inception_check_ignore_warning:this.state.inception_check_ignore_warning,inception_execute_ignore_error:this.state.inception_execute_ignore_error,split_sql_file_path:e,execute_user_name:this.state.login_user_name},a={},n=0;n<this.state.view_submit_split_sql_info.length;n++)a[this.state.view_submit_split_sql_info[n].split_seq]=this.state.view_submit_split_sql_info[n].dba_execute,this.state.view_submit_split_sql_info[n].split_sql_file_path===e&&(s=this.state.view_submit_split_sql_info[n].split_seq);for(l=[],r=0;r<this.state.view_check_sql_result.length;r++)l.push(this.state.view_check_sql_result[r].inception_error_level);if(2!==this.state.sql_check_max_code){c.next=11;break}A.a.error("\u5ba1\u6838\u5b58\u5728\u9519\u8bef,\u8bf7\u5148\u5904\u7406\u9519\u8bef"),c.next=26;break;case 11:if(0!==this.state.inception_check_ignore_warning||1!==this.state.sql_check_max_code){c.next=15;break}A.a.error("\u5ba1\u6838\u5b58\u5728\u8b66\u544a,\u8bf7\u5904\u7406\u8b66\u544a\u6216\u5ffd\u7565\u8b66\u544a\u6267\u884c"),c.next=26;break;case 15:if(1===s||"\u5df2\u6267\u884c"===a[s-1]){c.next=19;break}A.a.error("\u4e0a\u9762SQL\u6267\u884c\u5b8c\u6bd5\u4e0b\u9762SQL\u624d\u80fd\u6267\u884c"),c.next=26;break;case 19:if(this.state.execute_sql_flag===e){c.next=25;break}return this.setState({execute_sql_flag:e}),c.next=23,v.a.awrap(m.a.post("".concat(N,"/execute_submit_sql_by_file_path/"),{params:t}).then((function(e){"ok"===e.data.status?A.a.success(e.data.message,3)&&i.setInterVal():A.a.error(e.data.message)})));case 23:c.next=26;break;case 25:A.a.error("\u8be5\u5de5\u5355\u6b63\u5728\u6267\u884c,\u8bf7\u8bef\u591a\u6b21\u70b9\u51fb!!!");case 26:case"end":return c.stop()}}),null,this)}},{key:"ExecuteBySplitSqlFilePathManual",value:function(e){var t,a=this;return v.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return this.setState({execute_status:"\u6267\u884c\u4e2d"}),t={submit_sql_uuid:this.state.submit_sql_uuid,split_sql_file_path:e},n.next=4,v.a.awrap(m.a.post("".concat(N,"/execute_submit_sql_by_file_path_manual/"),{params:t}).then((function(e){"ok"===e.data.status?a.GetSqlApplyByUuid(a.state.submit_sql_uuid)&&A.a.success(e.data.message):A.a.error(e.data.message)})));case 4:case"end":return n.stop()}}),null,this)}},{key:"ShowInceptionVariableConfigModal",value:function(e){var t,a;return v.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t={split_sql_file_path:e},n.next=3,v.a.awrap(m.a.post("".concat(N,"/get_inception_variable_config_info/"),{params:t}));case 3:a=n.sent,console.log(a.data),this.setState({data:a.data.data}),this.cacheData=this.state.data.map((function(e){return Object($.a)({},e)})),this.setState({InceptionVariableConfigModalVisible:!0,split_sql_file_path:e});case 8:case"end":return n.stop()}}),null,this)}},{key:"ViewSplitSQL",value:function(e){var t,a;return v.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t={split_sql_file_path:e},n.next=3,v.a.awrap(m.a.post("".concat(N,"/get_submit_split_sql_by_file_path/"),{params:t}));case 3:"ok"===(a=n.sent).data.status?this.setState({SplitSQLModalVisible:!0,submit_split_sql:a.data.data}):A.a.error(a.data.message);case 5:case"end":return n.stop()}}),null,this)}},{key:"ViewExecuteSubmitSqlResultsByUuid",value:function(e){var t,a;return v.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log(e),t={submit_sql_uuid:this.state.submit_sql_uuid,split_sql_file_path:e},n.next=4,v.a.awrap(m.a.post("".concat(N,"/get_execute_results_by_split_sql_file_path/"),{params:t}));case 4:a=n.sent,this.setState({execute_sql_results:a.data.data,ViewExecuteSubmitSqlModalVisible:!0});case 6:case"end":return n.stop()}}),null,this)}},{key:"RecreateSql",value:function(e,t){var a,n;return v.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return console.log(e,t),a={submit_sql_uuid:this.state.submit_sql_uuid,split_sql_file_path:e,recreate_sql_flag:t},s.next=4,v.a.awrap(m.a.post("".concat(N,"/recreate_sql/"),{params:a}));case 4:n=s.sent,window.location.reload(),A.a.error(n.data.message),console.log(n);case 8:case"end":return s.stop()}}),null,this)}},{key:"getExecuteProcessByUuid",value:function(e){var t,a;return v.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t={submit_sql_uuid:this.state.submit_sql_uuid,split_sql_file_path:e},n.next=3,v.a.awrap(m.a.post("".concat(N,"/get_execute_process_by_uuid/"),{params:t}));case 3:a=n.sent,this.setState({execute_sql_process_results:a.data.data,ViewExecuteSubmitSqlProcessModalVisible:!0,split_sql_file_path:e}),this.timerProcessId=window.setInterval(this.getExecuteProcessByUuidTimeInterval.bind(this),1e3);case 6:case"end":return n.stop()}}),null,this)}},{key:"getExecuteProcessByUuidTimeInterval",value:function(){var e,t;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e={split_sql_file_path:this.state.split_sql_file_path,submit_sql_uuid:this.state.submit_sql_uuid},a.next=3,v.a.awrap(m.a.post("".concat(N,"/get_execute_process_by_uuid/"),{params:e}));case 3:(t=a.sent).data.data.length>0&&0!==t.data.data[0].inception_execute_percent?this.setState({execute_sql_process_results:t.data.data}):this.setState({ViewExecuteSubmitSqlProcessModalVisible:!1});case 5:case"end":return a.stop()}}),null,this)}},{key:"inceptionBackupCheckBoxOnChange",value:function(e){return v.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("inception_backup",e.target.checked),e.target.checked?console.log("\u5907\u4efd"):console.log("\u4e0d\u5907\u4efd"),e.target.checked?this.setState({inception_backup:1}):this.setState({inception_backup:0});case 3:case"end":return t.stop()}}),null,this)}},{key:"inceptionIgnoreWarningCheckBoxOnChange",value:function(e){return v.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("inception_execute_ignore_error","checked = ".concat(e.target.checked)),e.target.checked?console.log("\u5ffd\u7565inception\u8b66\u544a\u9009\u62e9\u6846"):console.log("\u4e0d\u5ffd\u7565inception\u8b66\u544a\u9009\u62e9\u6846"),e.target.checked?this.setState({inception_check_ignore_warning:1}):this.setState({inception_check_ignore_warning:0});case 3:case"end":return t.stop()}}),null,this)}},{key:"inceptionIgnoreErrorCheckBoxOnChange",value:function(e){return v.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("checked = ".concat(e.target.checked)),e.target.checked?console.log("\u5ffd\u7565inception\u9519\u8bef\u7ee7\u7eed\u6267\u884c\u9009\u62e9\u6846"):console.log("\u4e0d\u5ffd\u7565inception\u9519\u8bef\u7ee7\u7eed\u6267\u884c\u9009\u62e9\u6846"),e.target.checked?this.setState({inception_execute_ignore_error:1}):this.setState({inception_execute_ignore_error:0});case 3:case"end":return t.stop()}}),null,this)}},{key:"GetInceptionVariableConfig",value:function(){var e;return v.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a.awrap(m.a.get("".concat(N,"/get_inception_variable_config_info/")));case 2:e=t.sent,console.log(e.data),this.setState({data:e.data.data}),this.cacheData=this.state.data.map((function(e){return Object($.a)({},e)}));case 6:case"end":return t.stop()}}),null,this)}},{key:"handleUpdateInceptionVariable",value:function(){var e;return v.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:e={split_sql_file_path:this.state.split_sql_file_path,new_config_json:this.state.newConfig},m.a.post("".concat(N,"/update_inception_variable/"),{params:e}).then((function(e){"ok"===e.data.status?A.a.success(e.data.message):A.a.error(e.data.message)})).catch((function(e){A.a.error(e.message)})),this.setState({InceptionVariableConfigModalVisible:!1});case 3:case"end":return t.stop()}}),null,this)}},{key:"renderColumns",value:function(e,t,a){var n=this;return s.a.createElement(ne,{editable:"value"===a&&t.editable&&this.state.editingKey===t.name,value:e,onChange:function(e){return n.handleChange(e,t.name,a)}})}},{key:"handleChange",value:function(e,t,a){var n=this,s=Object(J.a)(this.state.data),l=s.filter((function(e){return t===e.name}))[0];if(l){l[a]=e;var r={};r[t]=e,this.setState({data:s,newClusterCfg:r},(function(){return console.log(n.state.newClusterCfg)}))}}},{key:"edit",value:function(e){""!==this.state.editingKey?(this.cancel(this.state.editingKey),this.setState({editingKey:e})):this.setState({editingKey:e})}},{key:"save",value:function(e){var t=this,a=Object(J.a)(this.state.data),n=a.filter((function(t){return e===t.name}))[0],s=Object(J.a)(this.cacheData).filter((function(t){return e===t.name}))[0],l=this.state.newConfig;n&&(this.state.newClusterCfg[this.state.editingKey]&&s.value!==n.value?(l[e]=n.value,this.setState({newConfig:l}),console.log("\u5f53\u524dincption\u914d\u7f6e",this.state.newConfig)):console.log("\u4e0d\u77e5\u9053"),this.setState({data:a,editingKey:""},(function(){return t.cacheData=t.state.data.map((function(e){return Object($.a)({},e)}))})))}},{key:"cancel",value:function(e){var t=Object(J.a)(this.state.data),a=t.filter((function(t){return e===t.name}))[0];a&&(Object.assign(a,this.cacheData.filter((function(t){return e===t.name}))[0]),this.setState({data:t,editingKey:""}))}},{key:"render",value:function(){var e=this,t={};return s.a.createElement("section",null,s.a.createElement("div",{className:"server-list"},s.a.createElement("div",{className:"sub-title"},s.a.createElement("div",null,s.a.createElement(g.b,{className:"title-text",to:"/"},"Home"),">",s.a.createElement(g.b,{className:"title-text",to:"/AuditSqlIndex"},"SQL\u5ba1\u6838"))),s.a.createElement("div",{className:"padding-container"},s.a.createElement("h3",null,"\u7533\u8bf7\u57fa\u7840\u4fe1\u606f"),s.a.createElement(x.a,{type:"flex",justify:"space-around"},s.a.createElement(C.a,{span:11,className:"col-detail"},s.a.createElement(x.a,{gutter:8},s.a.createElement(C.a,{style:{padding:5},span:8},"\u4e3b\u9898:"),s.a.createElement(C.a,{style:{padding:5},span:16},this.state.submit_sql_title)),s.a.createElement(x.a,{gutter:8},s.a.createElement(C.a,{style:{padding:5},span:8},"SQL\u9884\u89c8:"),s.a.createElement(f.a,{className:"link-button",loading:this.state.sql_view_loading,onClick:this.GetSubmitSqlByUuid.bind(this),style:{padding:5},span:16},"\u67e5\u770b")),s.a.createElement(x.a,{gutter:8},s.a.createElement(C.a,{style:{padding:5},span:8},"SQL\u5ba1\u6838\u7ed3\u679c:"),s.a.createElement(C.a,null,s.a.createElement(f.a,{style:{padding:5},span:16,className:"link-button",loading:this.state.sql_check_results_loading,onClick:function(){return e.setState({showSubmitSqlResultsVisible:!0})}},"\u67e5\u770b"),0!==this.state.sql_check_max_code?s.a.createElement("span",{style:{color:"red"}},[this.state.sql_check_code_explain]):s.a.createElement("span",{style:{color:"#52c41a"}},"[\u6b63\u5e38]"))),s.a.createElement(x.a,{gutter:8},s.a.createElement(C.a,{style:{padding:5},span:8},"SQL\u603b\u6761\u6570:"),s.a.createElement(C.a,{style:{padding:5},span:16},this.state.submit_sql_rows)),s.a.createElement(x.a,{gutter:8},s.a.createElement(C.a,{style:{padding:5},span:8},"SQL\u9884\u8ba1\u5f71\u54cd\u603b\u884c\u6570:"),s.a.createElement(C.a,{style:{padding:5},span:16},this.state.submit_sql_affect_rows)),s.a.createElement(x.a,{gutter:8},s.a.createElement(C.a,{style:{padding:5},span:8},"\u8bf7\u6c42\u63cf\u8ff0:"),s.a.createElement(C.a,{style:{padding:5},span:16},this.state.comment_info)),s.a.createElement(x.a,{gutter:8},s.a.createElement(C.a,{style:{padding:5},span:8},"\u6267\u884c\u7c7b\u578b:"),s.a.createElement(C.a,{style:{padding:5},span:16},this.state.submit_sql_execute_type))),s.a.createElement(C.a,{span:11,className:"col-detail"},this.state.cluster_name?null:s.a.createElement(x.a,{gutter:8},s.a.createElement(C.a,{style:{padding:5},span:6},"\u96c6\u7fa4\u4e3b\u5e93ip:"),s.a.createElement(C.a,{style:{padding:5},span:18},this.state.master_ip)),this.state.cluster_name?null:s.a.createElement(x.a,{gutter:8},s.a.createElement(C.a,{style:{padding:5},span:6},"\u96c6\u7fa4\u4e3b\u5e93port:"),s.a.createElement(C.a,{style:{padding:5},span:18},this.state.master_port)),this.state.cluster_name?s.a.createElement(x.a,{gutter:8},s.a.createElement(C.a,{style:{padding:5},span:6},"\u96c6\u7fa4\u540d:"),s.a.createElement(C.a,{style:{padding:5},span:18},this.state.cluster_name)):null,s.a.createElement(x.a,{gutter:8},s.a.createElement(C.a,{style:{padding:5},span:6},"\u7533\u8bf7\u8005:"),s.a.createElement(C.a,{style:{padding:5},span:18},this.state.submit_sql_user)),s.a.createElement(x.a,{gutter:8},s.a.createElement(C.a,{style:{padding:5},span:6},"Leader:"),s.a.createElement(C.a,{style:{padding:5},span:18},"[",this.state.leader_user_name,"]","\u901a\u8fc7"===this.state.leader_check?s.a.createElement("span",{style:{color:"#52c41a"}},"[",this.state.leader_check,"]"):s.a.createElement("span",{style:{color:"red"}},"[",this.state.leader_check,"]"))),s.a.createElement(x.a,{gutter:8},s.a.createElement(C.a,{style:{padding:5},span:6},"QA:"),s.a.createElement(C.a,{style:{padding:5},span:18},"[",this.state.qa_user_name,"]","\u901a\u8fc7"===this.state.qa_check?s.a.createElement("span",{style:{color:"#52c41a"}},"[",this.state.qa_check,"]"):s.a.createElement("span",{style:{color:"red"}},"[",this.state.qa_check,"]"))),s.a.createElement(x.a,{gutter:8},s.a.createElement(C.a,{style:{padding:5},span:6},"\u5ba1\u6838DBA:"),s.a.createElement(C.a,{style:{padding:5},span:18},"[",this.state.dba_check_user_name,"]","\u901a\u8fc7"===this.state.dba_check?s.a.createElement("span",{style:{color:"#52c41a"}},"[",this.state.dba_check,"]"):s.a.createElement("span",{style:{color:"red"}},"[",this.state.dba_check,"]"))),s.a.createElement(x.a,{gutter:8},s.a.createElement(C.a,{style:{padding:5},span:6},"\u6267\u884cDBA:"),s.a.createElement(C.a,{style:{padding:5},span:18},"[",this.state.dba_execute_user_name,"]","\u5df2\u6267\u884c"===this.state.dba_execute?s.a.createElement("span",{style:{color:"#52c41a"}},"[",this.state.dba_execute,"]"):s.a.createElement("span",{style:{color:"red"}},"[",this.state.dba_execute,"]"))))),s.a.createElement("br",null),"dba"!==this.state.login_user_name_role&&"leader"!==this.state.login_user_name_role&&"qa"!==this.state.login_user_name_role||!1!==this.state.sql_check_results_loading?null:s.a.createElement("div",null,s.a.createElement("h3",null,"\u5ba1\u6838\u64cd\u4f5c"),s.a.createElement("div",{className:"input-padding"},"\u672a\u5ba1\u6838"===this.state.leader_check&&"leader"===this.state.login_user_name_role?s.a.createElement(f.a,{type:"primary",style:{marginLeft:16},onClick:function(){return e.setState({ApplyModalVisible:!0})}},"\u5ba1\u6838"):null,"\u672a\u5ba1\u6838"===this.state.qa_check&&"qa"===this.state.login_user_name_role?s.a.createElement(f.a,{type:"primary",style:{marginLeft:16},onClick:function(){return e.setState({ApplyModalVisible:!0})}},"\u5ba1\u6838"):null,"\u672a\u5ba1\u6838"===this.state.dba_check&&"dba"===this.state.login_user_name_role?s.a.createElement(f.a,{type:"primary",style:{marginLeft:16},onClick:function(){return e.setState({ApplyModalVisible:!0})}},"\u5ba1\u6838"):null)),s.a.createElement("br",null),"dba"===this.state.login_user_name_role&&!1===this.state.sql_check_results_loading?s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement("h3",null,"\u6267\u884c\u9009\u9879"),s.a.createElement(ee.a,{defaultChecked:!0,onChange:this.inceptionBackupCheckBoxOnChange.bind(this)},"\u5907\u4efd"),s.a.createElement(ee.a,{onChange:this.inceptionIgnoreWarningCheckBoxOnChange.bind(this)},"\u5ffd\u7565inception\u8b66\u544a"),s.a.createElement(ee.a,{onChange:this.inceptionIgnoreErrorCheckBoxOnChange.bind(this)},"\u5ffd\u7565inception\u9519\u8bef\u5f3a\u5236\u6267\u884c")),s.a.createElement(S.a,{pagination:!1,dataSource:this.state.view_submit_split_sql_info,rowKey:function(e,t){return t},size:"small",bordered:!0},s.a.createElement(te,{title:"split_seq",dataIndex:"split_seq",key:"split_seq",render:function(a,n){var s={children:a,props:{}};return s.props.rowSpan=function(e,a,n){var s=0;return e!==t[n]&&(t[n]=e,a.forEach((function(e){console.log(e.split_seq),e.split_seq===t[n]&&(s+=1)}))),s}(n.split_seq,e.state.view_submit_split_sql_info,"split_seq"),s}}),s.a.createElement(te,{title:"SQL\u8def\u5f84",dataIndex:"split_sql_file_path",width:300}),s.a.createElement(te,{title:"SQL",render:function(t,a){return s.a.createElement("button",{className:"link-button",onClick:function(){e.ViewSplitSQL(a.split_sql_file_path)}},"\u67e5\u770b")}}),s.a.createElement(te,{title:"OSC\u914d\u7f6e",dataIndex:"inception_osc_config",render:function(t,a){return"\u901a\u8fc7"===e.state.dba_check&&"\u6267\u884c\u4e2d"!==e.state.execute_status?s.a.createElement("button",{className:"link-button",onClick:function(){e.ShowInceptionVariableConfigModal(a.split_sql_file_path)}},"OSC\u914d\u7f6e"):null}}),s.a.createElement(te,{title:"\u6267\u884cSQL",render:function(t,a){if("\u901a\u8fc7"===e.state.dba_check&&"\u672a\u6267\u884c"===a.execute_status&&"dba"===e.state.login_user_name_role)return s.a.createElement("div",null,s.a.createElement(f.a,{className:"link-button",onClick:function(){e.ExecuteBySplitSqlFilePath(a.split_sql_file_path)}},"\u5e73\u53f0\u6267\u884c"),s.a.createElement(f.a,{className:"link-button",style:{marginLeft:15},onClick:function(){e.ExecuteBySplitSqlFilePathManual(a.split_sql_file_path)}},"\u624b\u52a8\u6267\u884c"))}}),s.a.createElement(te,{title:"\u67e5\u770b\u8fdb\u5ea6",render:function(t,a){if("\u901a\u8fc7"===e.state.dba_check&&"\u6267\u884c\u4e2d"===a.execute_status)return s.a.createElement("button",{className:"link-button",onClick:function(){e.getExecuteProcessByUuid(a.split_sql_file_path)}},"\u67e5\u770b")}}),s.a.createElement(te,{title:"\u67e5\u770b\u7ed3\u679c",render:function(t,a){if("\u6267\u884c\u6210\u529f"===a.execute_status||"\u6267\u884c\u5931\u8d25"===a.execute_status||"\u6267\u884c\u6210\u529f(\u542b\u8b66\u544a)"===a.execute_status)return s.a.createElement("button",{className:"link-button",onClick:function(){e.ViewExecuteSubmitSqlResultsByUuid(a.split_sql_file_path)}},"\u67e5\u770b")}}),s.a.createElement(te,{title:"\u6267\u884c\u7ed3\u679c",dataIndex:"execute_status",render:function(t,a){return"\u6267\u884c\u6210\u529f"===t?s.a.createElement("span",{style:{color:"#52c41a"}},t):"\u6267\u884c\u5931\u8d25"===t&&0!==a.rerun_flag?s.a.createElement(s.a.Fragment,null,s.a.createElement("div",null,s.a.createElement("span",{style:{color:"#fa541c"}},t)),s.a.createElement("div",null,s.a.createElement("button",{className:"link-button",onClick:function(){e.RecreateSql(a.split_sql_file_path,"include_error_sql")}},"\u751f\u6210\u91cd\u505aSQL\u542b\u9519\u8befSQL")),s.a.createElement("div",null,s.a.createElement("button",{className:"link-button",onClick:function(){e.RecreateSql(a.split_sql_file_path,"ignore_error_sql")}},"\u751f\u6210\u91cd\u505aSQL\u5ffd\u7565\u9519\u8befSQL"))):"\u6267\u884c\u6210\u529f(\u542b\u8b66\u544a)"===t?s.a.createElement("span",{style:{color:"#ffbb96"}},t):s.a.createElement("span",{style:{color:"#bfbfbf"}},t)}}),s.a.createElement(te,{title:"\u6267\u884c\u65b9\u5f0f",dataIndex:"submit_sql_execute_plat_or_manual"}),s.a.createElement(te,{title:"\u8017\u65f6(\u79d2)",dataIndex:"inception_execute_time"}))):null,s.a.createElement(Q.a,{visible:this.state.showSubmitSqlViewVisible,onCancel:function(){return e.setState({showSubmitSqlViewVisible:!1})},title:"SQL\u9884\u89c8",footer:!1,width:960},s.a.createElement(ae,{wrap:"off",style:{minHeight:300,overflow:"scroll"},value:this.state.submit_sql})),s.a.createElement(Q.a,{visible:this.state.showSubmitSqlResultsVisible,onCancel:function(){return e.setState({showSubmitSqlResultsVisible:!1})},title:"SQL\u5ba1\u6838\u7ed3\u679c",footer:!1,width:1200},s.a.createElement(S.a,{dataSource:this.state.view_check_sql_result,rowKey:function(e,t){return t},rowClassName:function(e,t){var a="row-detail-default ";return 2===e.inception_error_level?a="row-detail-error":0===e.inception_error_level?a="row-detail-success":1===e.inception_error_level?a="row-detail-warning":a},pagination:!0,size:"small",columns:[{title:"ID",dataIndex:"inception_id",key:"inception_id"},{title:"SQL",dataIndex:"inception_sql",key:"inception_sql",width:500},{title:"\u72b6\u6001",dataIndex:"inception_stage_status",key:"inception_stage_status"},{title:"\u9519\u8bef\u4ee3\u7801",dataIndex:"inception_error_level",key:"inception_error_level",sorter:function(e,t){return e.inception_error_level-t.inception_error_level}},{title:"\u9519\u8bef\u4fe1\u606f",dataIndex:"inception_error_message",key:"inception_error_message"},{title:"\u5f71\u54cd\u884c\u6570",dataIndex:"inception_affected_rows",key:"inception_affected_rows"}]})),s.a.createElement(Q.a,{visible:this.state.ApplyModalVisible,onCancel:function(){return e.setState({ApplyModalVisible:!1})},title:"\u5ba1\u6838",footer:!1},s.a.createElement(ae,{rows:6,placeholder:"\u5ba1\u6838\u8bf4\u660e",onChange:function(t){return e.setState({check_comment:t.target.value})}}),s.a.createElement(x.a,{type:"flex",justify:"center",style:{marginTop:"10px"}},s.a.createElement(f.a,{onClick:this.PassSubmitSqlByUuid.bind(this,"\u901a\u8fc7"),loading:this.state.sql_check_pass_loading,type:"primary",style:{marginRight:"10px"}},"\u901a\u8fc7"),s.a.createElement(f.a,{onClick:this.PassSubmitSqlByUuid.bind(this,"\u4e0d\u901a\u8fc7"),loading:this.state.sql_check_pass_loading,type:"primary"},"\u4e0d\u901a\u8fc7"))),s.a.createElement(Q.a,{visible:this.state.ViewExecuteSubmitSqlModalVisible,onCancel:function(){return e.setState({ViewExecuteSubmitSqlModalVisible:!1})},title:"\u6267\u884c\u7ed3\u679c",footer:!1,width:1340},s.a.createElement(S.a,{dataSource:this.state.execute_sql_results,columns:[{title:"Id",dataIndex:"inception_id",key:"inception_id",width:50},{title:"\u9519\u8bef\u4ee3\u7801",dataIndex:"inception_error_level",key:"inception_error_level",width:100,sorter:function(e,t){var a=e.inception_error_level.toUpperCase(),n=t.inception_error_level.toUpperCase();return a<n?-1:a>n?1:0}},{title:"\u9636\u6bb5",dataIndex:"inception_stage",key:"inception_stage",width:100},{title:"\u9519\u8bef\u4fe1\u606f",dataIndex:"inception_error_message",key:"inception_error_message",width:540},{title:"sql",dataIndex:"inception_sql",key:"inception_sql",width:540},{title:"\u5b9e\u9645\u5f71\u54cd\u884c\u6570",dataIndex:"inception_affected_rows",key:"inception_affected_rows"},{title:"\u6267\u884c\u65f6\u95f4",dataIndex:"inception_execute_time",key:"inception_execute_time",width:90}],bordered:!0,rowKey:function(e,t){return t},rowClassName:function(e,t){var a="row-detail-default ";return"\u6267\u884c\u5931\u8d25"===e.inception_error_level?a="row-detail-error":"\u6267\u884c\u6210\u529f"===e.inception_error_level?a="row-detail-success":"\u6267\u884c\u6210\u529f(\u542b\u8b66\u544a)"===e.inception_error_level?a="row-detail-warning":a},size:"small"})),s.a.createElement(Q.a,{visible:this.state.ViewExecuteSubmitSqlProcessModalVisible,onCancel:function(){return e.setState({ViewExecuteSubmitSqlProcessModalVisible:!1})},title:"\u6267\u884c\u8fdb\u5ea6",footer:!1,width:1340},s.a.createElement(S.a,{dataSource:this.state.execute_sql_process_results,columns:[{title:"sql",dataIndex:"inception_sql",key:"inception_sql"},{title:"\u6267\u884c\u8fdb\u5ea6(%)",dataIndex:"inception_execute_percent",key:"inception_execute_percent"}],bordered:!0,size:"small"})),s.a.createElement(Q.a,{visible:this.state.InceptionVariableConfigModalVisible,onCancel:function(){return e.setState({InceptionVariableConfigModalVisible:!1})},title:"inception\u53d8\u91cf\u914d\u7f6e",footer:!1,width:1240},s.a.createElement(S.a,{dataSource:this.state.data,pagination:!1,columns:this.inception_varialbes_columns,rowKey:function(e){return e.name},size:"small"}),s.a.createElement(f.a,{type:"primary",onClick:this.handleUpdateInceptionVariable.bind(this)},"\u63d0\u4ea4\u66f4\u6539")),s.a.createElement(Q.a,{visible:this.state.SplitSQLModalVisible,onCancel:function(){return e.setState({SplitSQLModalVisible:!1})},title:"SQL\u9884\u89c8",footer:!1,width:960},s.a.createElement(ae,{wrap:"off",style:{minHeight:300,overflow:"scroll"},value:this.state.submit_split_sql})))))}}]),t}(n.Component);m.a.defaults.withCredentials=!0,m.a.defaults.headers.post["Content-Type"]="application/json";var le=k.a.Search,re="http://127.0.0.1:8000",ie=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={cluster_info:[]},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.GetClusterInfo()}},{key:"GetClusterInfo",value:function(){var e;return v.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a.awrap(m.a.get("".concat(re,"/get_cluster_info/")));case 2:e=t.sent,console.log(e.data),console.log(window&&window.location&&window.location.hostname),this.setState({cluster_info:e.data.data});case 6:case"end":return t.stop()}}),null,this)}},{key:"GetSearchClusterInfo",value:function(e){var t;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return this.setState({cluster_info:[]}),a.next=3,v.a.awrap(m.a.post("".concat(re,"/get_search_cluster_info/"),{cluster_name:e}));case 3:t=a.sent,console.log(t.data),this.setState({cluster_info:t.data.data});case 6:case"end":return a.stop()}}),null,this)}},{key:"render",value:function(){var e=this,t=this.state.cluster_info,a={},n=[{title:"cluster_name",dataIndex:"cluster_name",key:"cluster_name",render:function(e,n){var s={children:e,props:{}};return s.props.rowSpan=function(e,t,n){var s=0;return e!==a[n]&&(a[n]=e,t.forEach((function(e){e.cluster_name===a[n]&&(s+=1)}))),s}(n.cluster_name,t,"cluster_name"),s}},{title:"cluster_type",dataIndex:"cluster_type"},{title:"cluster_status",dataIndex:"cluster_status"},{title:"instance_name",colSpan:1,dataIndex:"instance_name"},{title:"role",dataIndex:"role"}];return s.a.createElement("div",{className:"server-list"},s.a.createElement("div",{className:"sub-title"},s.a.createElement("div",null,s.a.createElement(g.b,{className:"title-text",to:"/"},"Home"),">>",s.a.createElement(g.b,{className:"title-text",to:"/mysqlCluster"},"\u96c6\u7fa4\u4fe1\u606f")),s.a.createElement("div",null,s.a.createElement(le,{placeholder:"\u96c6\u7fa4\u540d",onSearch:function(t){return e.GetSearchClusterInfo(t)},style:{width:200},allowClear:!0}))),s.a.createElement("div",null),s.a.createElement(S.a,{dataSource:this.state.cluster_info,columns:n,bordered:!0}))}}]),t}(n.Component);m.a.defaults.withCredentials=!0,m.a.defaults.headers.post["Content-Type"]="application/json";var ce="http://127.0.0.1:8000",oe=B.a.Item,ue=ee.a.Group,de=["insert,delete,update","select","create","drop","alter","replication slave,replication client"],_e=["select"],me=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields((function(e,t){console.log("Received values of form: ",t);var n={grant_db_master_ip:t.DB_master_ip,grant_db_master_port:t.DB_master_port,grant_user_name:t.User_name,grant_user_host:t.User_ip,grant_database:t.Database,grant_table:t.Table,grant_dev_name:a.state.login_user_name,grant_privileges:a.state.checkedList.join(",")};m.a.post("".concat(ce,"/privileges_create_user_info/"),{params:n}).then((function(e){"ok"===e.data.status?A.a.success(e.data.message)&&a.props.form.resetFields():A.a.error(e.data.message)})).catch((function(e){A.a.error(e.message)})),a.setState({showDataVisible:!1})}))},a.onChange=function(e){console.log(e.join(",")),a.setState({checkedList:e,indeterminate:!!e.length&&e.length<de.length,checkAll:e.length===de.length})},a.onCheckAllChange=function(e){a.setState({checkedList:e.target.checked?de:[],indeterminate:!1,checkAll:e.target.checked})},a.state={user_info:[],showDataVisible:!1,confirmLoading:!1,checkedList:_e,indeterminate:!0,login_user_name:"",login_user_name_role:""},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;D().then((function(t){e.setState({login_user_name:t.data.username,login_user_name_role:t.data.title})})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return s.a.createElement("div",{className:"server-list"},s.a.createElement("div",null,s.a.createElement(B.a,{className:"ant-advanced-search-form",labelCol:{span:4},onSubmit:this.handleSubmit},s.a.createElement(x.a,{gutter:20},s.a.createElement(I.a,null,s.a.createElement(oe,{label:"DB_master_ip"},e("DB_master_ip",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165DB_master_ip"}]})(s.a.createElement(k.a,{style:{width:"20%"},placeholder:"\u8bf7\u8f93\u5165DB_master_ip"}))),s.a.createElement(oe,{label:"DB_master_port"},e("DB_master_port",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165DB_master_port"}]})(s.a.createElement(k.a,{style:{width:"20%"},placeholder:"\u8bf7\u8f93\u5165DB_master_port"}))),s.a.createElement(oe,{label:"User_name"},e("User_name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165User_name"}]})(s.a.createElement(k.a,{style:{width:"20%"},placeholder:"\u8bf7\u8f93\u5165User_name"}))),s.a.createElement(oe,{label:"User_ip"},e("User_ip",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165User_ip"}]})(s.a.createElement(k.a,{style:{width:"20%"},placeholder:"\u8bf7\u8f93\u5165User_ip"}))),s.a.createElement(oe,{label:"Database"},e("Database",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u9700\u8981\u6388\u6743\u7684Database"}]})(s.a.createElement(k.a,{style:{width:"20%"},placeholder:"\u8bf7\u8f93\u5165\u9700\u8981\u6388\u6743\u7684Database"}))),s.a.createElement(oe,{label:"Table"},e("Table",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u9700\u8981\u6388\u6743\u7684Table"}]})(s.a.createElement(k.a,{style:{width:"20%"},placeholder:"\u8bf7\u8f93\u5165\u9700\u8981\u6388\u6743\u7684Table"}))),s.a.createElement(oe,{label:"Privileges"},e("Privileges")(s.a.createElement("div",null,s.a.createElement(ue,{options:de,value:this.state.checkedList,onChange:this.onChange}))))),s.a.createElement(f.a,{type:"primary",htmlType:"submit"},"submit")))))}}]),t}(s.a.Component);me=B.a.create()(me),m.a.defaults.withCredentials=!0,m.a.defaults.headers.post["Content-Type"]="application/json";var pe="http://127.0.0.1:8000",he=B.a.Item,fe=ee.a.Group,be=S.a.Column,ge=["insert,delete,update","select","create","drop","alter","replication slave,replication client"],Ee=["select"],ye=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields((function(e,t){console.log("Received values of form: ",t);var n={grant_db_master_ip:t.DB_master_ip,grant_db_master_port:t.DB_master_port,grant_user_name:t.User_name,grant_dev_name:a.state.login_user_name,grant_privileges:a.state.checkedList.join(",")};m.a.post("".concat(pe,"/privileges_extend_info/"),{params:n}).then((function(e){"ok"===e.data.status?A.a.success(e.data.message)&&a.props.form.resetFields():A.a.error(e.data.message)})).catch((function(e){A.a.error(e.message)})),a.setState({showDataVisible:!1})}))},a.handleHostPortChange=function(e){console.log(e),a.setState({grant_db_master_port:e})},a.handleHostIpChange=function(e){console.log(e),a.setState({grant_db_master_ip:e})},a.handleUserChange=function(e){console.log(e),a.setState({grant_user_name:e})},a.onChange=function(e){console.log(e.join(",")),a.setState({checkedList:e,indeterminate:!!e.length&&e.length<ge.length,checkAll:e.length===ge.length})},a.onCheckAllChange=function(e){a.setState({checkedList:e.target.checked?ge:[],indeterminate:!1,checkAll:e.target.checked})},a.state={user_info:[],showDataVisible:!1,confirmLoading:!1,checkedList:Ee,indeterminate:!0,login_user_name:"",login_user_name_role:"",grant_dev_name:"",privileges_info:[],grant_db_master_port:"",grant_db_master_ip:"",grant_user_name:""},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;D().then((function(t){e.setState({login_user_name:t.data.username,login_user_name_role:t.data.title})})).catch((function(e){console.log(e)}))}},{key:"handleViewPrivileges",value:function(){var e,t=this;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:e={grant_db_master_port:this.state.grant_db_master_port,grant_db_master_ip:this.state.grant_db_master_ip,grant_user_name:this.state.grant_user_name},console.log(e),m.a.post("".concat(pe,"/privilege_view_user/"),{params:e}).then((function(e){console.log(e.data),t.setState({privileges_info:e.data})})).catch((function(e){A.a.error(e.message)}));case 3:case"end":return a.stop()}}),null,this)}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator;return s.a.createElement("div",{className:"server-list"},s.a.createElement("div",null,s.a.createElement(B.a,{className:"ant-advanced-search-form",labelCol:{span:4},onSubmit:this.handleSubmit},s.a.createElement(x.a,{gutter:20},s.a.createElement(I.a,null,s.a.createElement(he,{label:"DB_master_ip"},t("DB_master_ip",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165DB_master_ip"}]})(s.a.createElement(k.a,{style:{width:"20%"},placeholder:"\u8bf7\u8f93\u5165DB_master_ip",onChange:function(t){return e.handleHostIpChange(t.target.value)}}))),s.a.createElement(he,{label:"DB_master_port"},t("DB_master_port",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165DB_master_port"}]})(s.a.createElement(k.a,{style:{width:"20%"},placeholder:"\u8bf7\u8f93\u5165DB_master_port",onChange:function(t){return e.handleHostPortChange(t.target.value)}}))),s.a.createElement(he,{label:"User_name"},t("User_name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165User_name"}]})(s.a.createElement(k.a,{style:{width:"20%"},placeholder:"\u8bf7\u8f93\u5165User_name",onChange:function(t){return e.handleUserChange(t.target.value)}})),s.a.createElement(f.a,{type:"primary",style:{marginLeft:10},onClick:function(){e.handleViewPrivileges()}},"\u67e5\u770b\u5df2\u6709\u6743\u9650")),s.a.createElement(he,{label:"Privileges"},t("Privileges")(s.a.createElement("div",null,s.a.createElement(fe,{options:ge,value:this.state.checkedList,onChange:this.onChange}))))),s.a.createElement(f.a,{type:"primary",htmlType:"submit"},"submit")),s.a.createElement(S.a,{dataSource:this.state.privileges_info,pagination:{pageSize:10},scroll:{y:400},rowKey:function(e,t){return t},size:"small"},s.a.createElement(be,{title:"\u7528\u6237\u540d",dataIndex:"user"}),s.a.createElement(be,{title:"IP",dataIndex:"host"}),s.a.createElement(be,{title:"\u5df2\u6709\u6743\u9650",dataIndex:"privilege"}),s.a.createElement(be,{title:"\u6570\u636e\u5e93",dataIndex:"db"})))))}}]),t}(s.a.Component);ye=B.a.create()(ye),m.a.defaults.withCredentials=!0,m.a.defaults.headers.post["Content-Type"]="application/json";var ve=k.a.Search,ke=w.a.TabPane,we=S.a.Column;function Se(e){console.log(e)}var qe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={user_info:[],showDataVisible:!1,confirmLoading:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.GetUserInfo()}},{key:"GetUserInfo",value:function(){var e;return v.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a.awrap(m.a.get("".concat("http://127.0.0.1:8000","/get_private_user_info/")));case 2:e=t.sent,console.log(e.data),this.setState({user_info:e.data});case 5:case"end":return t.stop()}}),null,this)}},{key:"GetSearchUserInfo",value:function(e){var t;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,v.a.awrap(m.a.post("".concat("http://127.0.0.1:8000","/get_private_user_info/"),{user_name:e}));case 2:t=a.sent,console.log(t.data),this.setState({user_info:t.data});case 5:case"end":return a.stop()}}),null,this)}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"server-list"},s.a.createElement("div",{className:"sub-title"},s.a.createElement("div",null,s.a.createElement(g.b,{className:"title-text",to:"/"},"Home"),">>",s.a.createElement(g.b,{className:"title-text",to:"/privilegesApply"},"\u7528\u6237\u6743\u9650\u7533\u8bf7")),s.a.createElement("div",null,s.a.createElement(ve,{placeholder:"\u7528\u6237\u540d",onSearch:function(t){return e.GetSearchUserInfo(t)},style:{width:200},allowClear:!0}))),s.a.createElement("div",null,s.a.createElement(w.a,{defaultActiveKey:"1",onChange:Se},s.a.createElement(ke,{tab:"\u5de5\u5355\u7533\u8bf7\u8868",key:"1"},s.a.createElement(S.a,{dataSource:this.state.user_info,pagination:{pageSize:10},rowKey:function(e,t){return t},rowClassName:function(e,t){var a="row-detail-default ";return"\u672a\u5ba1\u6838"!==e.leader_check_result&&"\u672a\u5ba1\u6838"!==e.dba_check_result&&"\u672a\u6267\u884c"!==e.status&&"\u6267\u884c\u5931\u8d25"!==e.status||(a="row-detail-error"),a},size:"small"},s.a.createElement(we,{title:"\u7533\u8bf7\u4eba",dataIndex:"person_name"}),s.a.createElement(we,{title:"\u5de5\u5355\u7c7b\u578b",dataIndex:"request_type"}),s.a.createElement(we,{title:"\u90e8\u95e8",dataIndex:"department"}),s.a.createElement(we,{title:"\u4e1a\u52a1leader",dataIndex:"leader"}),s.a.createElement(we,{title:"DBA",dataIndex:"dba"}),s.a.createElement(we,{title:"Leader\u5ba1\u6838",dataIndex:"leader_check_result"}),s.a.createElement(we,{title:"DBA\u5ba1\u6838",dataIndex:"dba_check_result"}),s.a.createElement(we,{title:"\u5de5\u5355\u72b6\u6001",dataIndex:"status"}),s.a.createElement(we,{title:"\u7533\u8bf7\u65f6\u95f4",dataIndex:"ctime"}),s.a.createElement(we,{title:"\u64cd\u4f5c",render:function(e){return s.a.createElement(g.b,{to:"/viewPrivilegeInfoByUuid/".concat(e.order_uuid)},"\u67e5\u770b")}}))),s.a.createElement(ke,{tab:"\u6dfb\u52a0\u65b0\u7528\u6237",key:"2"},s.a.createElement(me,null)),s.a.createElement(ke,{tab:"\u6269\u5c55\u6743\u9650",key:"3"},s.a.createElement(ye,null)),s.a.createElement(ke,{tab:"\u6269\u5c55IP",key:"4"},s.a.createElement(ye,null)),s.a.createElement(ke,{tab:"\u6269\u5c55\u5e93\u8868",key:"5"},s.a.createElement(ye,null)))))}}]),t}(n.Component),xe=B.a.create()(qe);m.a.defaults.withCredentials=!0,m.a.defaults.headers.post["Content-Type"]="application/json";var Ce=S.a.Column,Ie=k.a.TextArea,Ne=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).showCheckModal=function(){a.setState({checkOrderVisible:!0})},a.handleCancel=function(e){console.log(e),a.setState({checkOrderVisible:!1})},a.state={showDataVisible:!1,checkOrderVisible:!1,confirmLoading:!1,indeterminate:!0,dev_name:"",request_type:"",department:"",leader:"",dba:"",leader_check_result:"",dba_check_result:"",db_master_ip:"",db_master_port:"",user_host:"",db_name:"",tb_name:"",user_name:"",ctime:"",utime:"",order_info:[],login_user_name:"",login_user_name_role:""},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.GetUserInfo(),D().then((function(t){e.setState({login_user_name:t.data.username,login_user_name_role:t.data.title})})).catch((function(e){console.log(e)}))}},{key:"GetUserInfo",value:function(){var e,t;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return console.log(this.props.match.params.order_uuid),e={order_uuid:this.props.match.params.order_uuid},a.next=4,v.a.awrap(m.a.post("".concat("http://127.0.0.1:8000","/get_order_info/"),{params:e}));case 4:t=a.sent,console.log(t.data),this.setState({dev_name:t.data[0].person_name,leader:t.data[0].leader,dba:t.data[0].dba,department:t.data[0].department,request_type:t.data[0].request_type,leader_check_result:t.data[0].leader_check_result,dba_check_result:t.data[0].dba_check_result,db_master_port:t.data[0].db_master_port,db_master_ip:t.data[0].db_master_ip,user_name:t.data[0].user_name,execute_status:t.data[0].status,utime:t.data[0].utime,ctime:t.data[0].ctime,order_info:t.data});case 7:case"end":return a.stop()}}),null,this)}},{key:"handleCheckSubmitPass",value:function(){var e,t=this;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:console.log(this.props.match.params.order_uuid),e={order_uuid:this.props.match.params.order_uuid,check_result:"\u901a\u8fc7",login_user_name_role:this.state.login_user_name_role},console.log(e),m.a.post("".concat("http://127.0.0.1:8000","/check_order/"),{params:e}).then((function(e){"ok"===e.data.status?A.a.success(e.data.message,2)&&t.GetUserInfo():A.a.error(e.data.message)&&t.GetUserInfo()})).catch((function(e){A.a.error(e.message,2)})),this.setState({checkOrderVisible:!1});case 5:case"end":return a.stop()}}),null,this)}},{key:"handleCheckSubmitNoPass",value:function(){var e,t=this;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:console.log(this.props.match.params.order_uuid),e={order_uuid:this.props.match.params.order_uuid,check_result:"\u4e0d\u901a\u8fc7",login_user_name_role:this.state.login_user_name_role},console.log(e),m.a.post("".concat("http://127.0.0.1:8000","/check_order/"),{params:e}).then((function(e){"ok"===e.data.status?A.a.success(e.data.message,2)&&t.GetUserInfo():A.a.error(e.data.message)&&t.GetUserInfo()})).catch((function(e){A.a.error(e.message,2)})),this.setState({checkOrderVisible:!1});case 5:case"end":return a.stop()}}),null,this)}},{key:"handleSqlSubmit",value:function(){var e,t=this;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:console.log(this.props.match.params.order_uuid),e={order_uuid:this.props.match.params.order_uuid},console.log(e),m.a.post("".concat("http://127.0.0.1:8000","/execute_order/"),{params:e}).then((function(e){"ok"===e.data.status?A.a.success(e.data.message)&&t.GetUserInfo():A.a.error(e.data.message)&&t.GetUserInfo()})).catch((function(e){A.a.error(e.message)})),this.setState({showDataVisible:!1});case 5:case"end":return a.stop()}}),null,this)}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"server-list"},s.a.createElement("div",{className:"sub-title"},s.a.createElement("div",null,s.a.createElement(g.b,{className:"title-text",to:"/"},"Home"),">>",s.a.createElement(g.b,{className:"title-text",to:"/privilegesApply"},"\u7528\u6237\u6743\u9650\u7533\u8bf7"))),s.a.createElement("div",null,s.a.createElement(x.a,{gutter:20},s.a.createElement(I.a,{title:"\u7533\u8bf7\u57fa\u7840\u4fe1\u606f",bordered:!1},s.a.createElement(C.a,{span:8},s.a.createElement("p",null,"\u7533\u8bf7\u4eba: ",this.state.dev_name),s.a.createElement("p",null,"leader: ",this.state.leader,"[",this.state.leader_check_result,"]"),s.a.createElement("p",null,"DBA: ",this.state.dba,"[",this.state.dba_check_result,"]"),s.a.createElement("p",null,"\u90e8\u95e8: ",this.state.department),s.a.createElement("p",null,"\u5de5\u5355\u7c7b\u578b: ",this.state.request_type)),s.a.createElement(C.a,{span:8},s.a.createElement("p",null,"\u6570\u636e\u5e93\u5730\u5740: ",this.state.db_master_ip),s.a.createElement("p",null,"\u6570\u636e\u5e93\u7aef\u53e3: ",this.state.db_master_port),s.a.createElement("p",null,"\u5de5\u5355\u521b\u5efa\u65f6\u95f4: ",this.state.ctime),s.a.createElement("p",null,"\u5de5\u5355\u66f4\u65b0\u65f6\u95f4: ",this.state.utime),s.a.createElement("p",null,"\u6267\u884c\u72b6\u6001: ",this.state.execute_status))),s.a.createElement(I.a,{title:"\u6743\u9650\u8be6\u7ec6\u4fe1\u606f",bordered:!1},s.a.createElement(S.a,{dataSource:this.state.order_info,pagination:{pageSize:10},scroll:{y:400},rowKey:function(e,t){return t},size:"small"},s.a.createElement(Ce,{title:"\u7528\u6237\u540d",dataIndex:"user_name"}),s.a.createElement(Ce,{title:"\u4e3b\u673a\u5217\u8868",dataIndex:"user_host"}),s.a.createElement(Ce,{title:"\u6570\u636e\u5e93\u5217\u8868",dataIndex:"db_name"}),s.a.createElement(Ce,{title:"\u6743\u9650\u5217\u8868",dataIndex:"privileges"}))))),s.a.createElement("div",null,"leader"===this.state.login_user_name_role&&"\u672a\u5ba1\u6838"===this.state.leader_check_result?s.a.createElement(f.a,{type:"primary",onClick:function(){e.showCheckModal()}},"\u5ba1\u6838"):null,"dba"===this.state.login_user_name_role&&"\u672a\u5ba1\u6838"===this.state.dba_check_result&&"\u901a\u8fc7"===this.state.leader_check_result?s.a.createElement(f.a,{type:"primary",onClick:function(){e.showCheckModal()}},"\u5ba1\u6838"):null,"dba"===this.state.login_user_name_role&&"\u901a\u8fc7"===this.state.dba_check_result&&"\u672a\u6267\u884c"===this.state.execute_status?s.a.createElement(f.a,{type:"primary",onClick:function(){e.handleSqlSubmit()}},"\u6267\u884c"):null),s.a.createElement(Q.a,{title:"\u5de5\u5355\u5ba1\u6838",visible:this.state.checkOrderVisible,onCancel:this.handleCancel,okText:"\u901a\u8fc7",cancelText:"\u4e0d\u901a\u8fc7",footer:null},s.a.createElement(Ie,null),s.a.createElement(f.a,{type:"primary",onClick:function(){e.handleCheckSubmitPass()}},"\u901a\u8fc7"),s.a.createElement(f.a,{type:"primary",onClick:function(){e.handleCheckSubmitNoPass()}},"\u4e0d\u901a\u8fc7")))}}]),t}(s.a.Component);Ne=B.a.create()(Ne),m.a.defaults.withCredentials=!0,m.a.defaults.headers.post["Content-Type"]="application/json";var Oe="http://127.0.0.1:8000",De=B.a.Item,je=ee.a.Group,Le=["insert,delete,update","select","create","drop","alter","replication slave,replication client"],Ve=["select"],Me=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields((function(e,t){console.log("Received values of form: ",t);var n={grant_user_name:t.User_name,grant_user_host:t.Host,grant_database:t.Database,grant_table:t.Table,grant_privileges:a.state.checkedList.join(",")};m.a.post("".concat(Oe,"/grant_user_info/"),{params:n}).then((function(e){"ok"===e.data.status?A.a.success(e.data.message)&&a.props.form.resetFields():A.a.error(e.data.message)})).catch((function(e){A.a.error(e.message)})),a.setState({showDataVisible:!1})}))},a.onChange=function(e){console.log(e.join(",")),a.setState({checkedList:e,indeterminate:!!e.length&&e.length<Le.length,checkAll:e.length===Le.length})},a.onCheckAllChange=function(e){a.setState({checkedList:e.target.checked?Le:[],indeterminate:!1,checkAll:e.target.checked})},a.state={user_info:[],showDataVisible:!1,confirmLoading:!1,checkedList:Ve,indeterminate:!0},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return s.a.createElement("div",{className:"server-list"},s.a.createElement("div",null,s.a.createElement(B.a,{className:"ant-advanced-search-form",labelCol:{span:4},onSubmit:this.handleSubmit},s.a.createElement(x.a,{gutter:20},s.a.createElement(I.a,null,s.a.createElement(De,{label:"User_name"},e("User_name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165User_name"}]})(s.a.createElement(k.a,{style:{width:"20%"},placeholder:"\u8bf7\u8f93\u5165User_name"}))),s.a.createElement(De,{label:"Host"},e("Host",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165Host"}]})(s.a.createElement(k.a,{style:{width:"20%"},placeholder:"\u8bf7\u8f93\u5165Host"}))),s.a.createElement(De,{label:"Database"},e("Database",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u9700\u8981\u6388\u6743\u7684Database"}]})(s.a.createElement(k.a,{style:{width:"20%"},placeholder:"\u8bf7\u8f93\u5165\u9700\u8981\u6388\u6743\u7684Database"}))),s.a.createElement(De,{label:"Table"},e("Table",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u9700\u8981\u6388\u6743\u7684Table"}]})(s.a.createElement(k.a,{style:{width:"20%"},placeholder:"\u8bf7\u8f93\u5165\u9700\u8981\u6388\u6743\u7684Table"}))),s.a.createElement(De,{label:"Privileges"},e("Privileges")(s.a.createElement("div",null,s.a.createElement(je,{options:Le,value:this.state.checkedList,onChange:this.onChange}))))),s.a.createElement(f.a,{type:"primary",htmlType:"submit"},"submit")))))}}]),t}(s.a.Component);Me=B.a.create()(Me),m.a.defaults.withCredentials=!0,m.a.defaults.headers.post["Content-Type"]="application/json";var Ue="http://127.0.0.1:8000",Be=B.a.Item,Te=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleMigrateSubmit=function(e){e.preventDefault(),a.props.form.validateFields((function(e,t){console.log("Received values of form: ",t);var a={des_master_ip:t.des_master_ip,des_master_port:t.des_master_port};m.a.post("".concat(Ue,"/migrate_common_user/"),{params:a}).then((function(e){"ok"===e.data.status?A.a.success(e.data.message):A.a.error(e.data.message)})).catch((function(e){A.a.error(e.message)}))})),a.props.form.resetFields()},a.state={},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return s.a.createElement("div",{className:"server-list"},s.a.createElement("div",null,s.a.createElement(B.a,{className:"ant-advanced-search-form",labelCol:{span:4},onSubmit:this.handleMigrateSubmit},s.a.createElement(x.a,{gutter:24},s.a.createElement(I.a,null,s.a.createElement(Be,{label:"des_master_ip"},e("des_master_ip",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165des_master_ip"}]})(s.a.createElement(k.a,{placeholder:"\u8bf7\u8f93\u5165des_master_ip",style:{width:"20%"}}))),s.a.createElement(Be,{label:"des_master_port"},e("des_master_port",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165des_master_port"}]})(s.a.createElement(k.a,{placeholder:"\u8bf7\u8f93\u5165des_master_port:",style:{width:"20%"}})))),s.a.createElement(f.a,{type:"primary",htmlType:"submit"},"\u540c\u6b65")))))}}]),t}(s.a.Component);Te=B.a.create()(Te),m.a.defaults.withCredentials=!0,m.a.defaults.headers.post["Content-Type"]="application/json";var Ae=k.a.Search,Pe="http://127.0.0.1:8000",Ge=B.a.Item,Qe=w.a.TabPane;function ze(e){console.log(e)}var He=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).showDataHandleCancel=function(e){a.setState({showDataVisible:!1})},a.showMigrateAccountModalHandleCancel=function(e){a.setState({showMigrateAccountDataVisible:!1})},a.handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields((function(e,t){console.log("Received values of form: ",t);var n={grant_user_name:t.User_name,grant_user_host:t.Host,grant_database:t.Database,grant_table:t.Table,grant_privileges:t.Privileges};m.a.post("".concat(Pe,"/grant_user_info/"),{params:n});a.setState({showDataVisible:!1})}))},a.state={des_name:"",user_info:[],showDataVisible:!1,showMigrateAccountDataVisible:!1,confirmLoading:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.GetUserInfo()}},{key:"GetUserInfo",value:function(){var e;return v.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a.awrap(m.a.get("".concat(Pe,"/get_user_info/")));case 2:e=t.sent,console.log(e.data),this.setState({user_info:e.data});case 5:case"end":return t.stop()}}),null,this)}},{key:"GetSearchUserInfo",value:function(e){var t;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,v.a.awrap(m.a.post("".concat(Pe,"/get_user_info/"),{user_name:e}));case 2:t=a.sent,console.log(t.data),this.setState({user_info:t.data});case 5:case"end":return a.stop()}}),null,this)}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.state.user_info,n={},l=[{title:"user_name",dataIndex:"user_name",width:100,key:"user_name",render:function(e,t){var s={children:e,props:{}};return s.props.rowSpan=function(e,t,a){var s=0;return e!==n[a]&&(n[a]=e,t.forEach((function(e){e.user_name===n[a]&&(s+=1)}))),s}(t.user_name,a,"user_name"),s}},{title:"user_password",dataIndex:"user_password",width:100},{title:"user_host",dataIndex:"user_host",width:100},{title:"privileges",dataIndex:"privileges",width:200},{title:"db_name",dataIndex:"db_name",width:100},{title:"tb_name",dataIndex:"tb_name",width:100},{title:"status",dataIndex:"status",width:100}];return s.a.createElement("div",{className:"server-list"},s.a.createElement("div",{className:"sub-title"},s.a.createElement("div",null,s.a.createElement(g.b,{className:"title-text",to:"/"},"Home"),">>",s.a.createElement(g.b,{className:"title-text",to:"/commonUser"},"\u516c\u5171\u8d26\u53f7\u4fe1\u606f")),s.a.createElement("div",null,s.a.createElement(Ae,{placeholder:"\u7528\u6237\u540d",onSearch:function(t){return e.GetSearchUserInfo(t)},style:{width:200},allowClear:!0}))),s.a.createElement("div",null,s.a.createElement(w.a,{defaultActiveKey:"1",onChange:ze},s.a.createElement(Qe,{tab:"\u516c\u5171\u8d26\u53f7\u5217\u8868",key:"1"},s.a.createElement(S.a,{columns:l,dataSource:this.state.user_info,pagination:{pageSize:10},scroll:{y:400},size:"small"})),s.a.createElement(Qe,{tab:"\u6dfb\u52a0\u516c\u5171\u8d26\u53f7",key:"2"},s.a.createElement(Me,null)),s.a.createElement(Qe,{tab:"\u540c\u6b65\u516c\u5171\u8d26\u53f7",key:"3"},s.a.createElement(Te,null)))),s.a.createElement(Q.a,{title:"\u6dfb\u52a0\u516c\u5171\u8d26\u53f7",visible:this.state.showDataVisible,onCancel:this.showDataHandleCancel,width:"960px",footer:!1},s.a.createElement(B.a,{className:"ant-advanced-search-form",labelCol:{span:4},onSubmit:this.handleSubmit},s.a.createElement(x.a,{gutter:20},s.a.createElement(I.a,null,s.a.createElement(Ge,{label:"User_name"},t("User_name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165User_name"}]})(s.a.createElement(k.a,{style:{width:"20%"},placeholder:"\u8bf7\u8f93\u5165User_name"}))),s.a.createElement(Ge,{label:"Host"},t("Host",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165Host"}]})(s.a.createElement(k.a,{style:{width:"20%"},placeholder:"\u8bf7\u8f93\u5165Host"}))),s.a.createElement(Ge,{label:"Database"},t("Database",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u9700\u8981\u6388\u6743\u7684Database"}]})(s.a.createElement(k.a,{style:{width:"20%"},placeholder:"\u8bf7\u8f93\u5165\u9700\u8981\u6388\u6743\u7684Database"}))),s.a.createElement(Ge,{label:"Table"},t("Table",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u9700\u8981\u6388\u6743\u7684Table"}]})(s.a.createElement(k.a,{style:{width:"20%"},placeholder:"\u8bf7\u8f93\u5165\u9700\u8981\u6388\u6743\u7684Table"}))),s.a.createElement(Ge,{label:"Privileges"},t("Privileges",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u9700\u8981\u7533\u8bf7\u7684Privileges"}]})(s.a.createElement(k.a,{style:{width:"50%"},placeholder:"\u8bf7\u8f93\u5165\u9700\u8981\u7533\u8bf7\u7684Privileges"})))),s.a.createElement(f.a,{type:"primary",htmlType:"submit"},"submit")))),s.a.createElement(Q.a,{title:"\u540c\u6b65\u516c\u5171\u8d26\u53f7",visible:this.state.showMigrateAccountDataVisible,onCancel:this.showMigrateAccountModalHandleCancel,width:"960px",footer:!1},s.a.createElement(B.a,{className:"ant-advanced-search-form",labelCol:{span:4},onSubmit:this.handleMigrateSubmit},s.a.createElement(x.a,{gutter:24},s.a.createElement(I.a,null,s.a.createElement(Ge,{label:"des_master_ip"},t("des_master_ip",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165des_master_ip"}]})(s.a.createElement(k.a,{placeholder:"\u8bf7\u8f93\u5165des_master_ip"}))),s.a.createElement(Ge,{label:"des_master_port"},t("des_master_port",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165des_master_port"}]})(s.a.createElement(k.a,{placeholder:"\u8bf7\u8f93\u5165des_master_port:"})))),s.a.createElement(f.a,{type:"primary",htmlType:"submit"},"\u540c\u6b65")))))}}]),t}(n.Component),Ke=B.a.create()(He);m.a.defaults.withCredentials=!0,m.a.defaults.headers.post["Content-Type"]="application/json";var Re=k.a.Search,Fe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={cloud_instance_info:[]},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.GetClusterInfo()}},{key:"GetClusterInfo",value:function(){var e;return v.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a.awrap(m.a.get("".concat("http://127.0.0.1:8000","/get_cloud_info/")));case 2:e=t.sent,console.log(e.data),this.setState({cloud_instance_info:e.data});case 5:case"end":return t.stop()}}),null,this)}},{key:"GetSearchClusterInfo",value:function(e){var t;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,v.a.awrap(m.a.post("".concat("http://127.0.0.1:8000","/get_cloud_info/"),{instance_name:e}));case 2:t=a.sent,console.log(t.data),this.setState({cloud_instance_info:t.data});case 5:case"end":return a.stop()}}),null,this)}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"server-list"},s.a.createElement("div",{className:"sub-title"},s.a.createElement("div",null,s.a.createElement(g.b,{className:"title-text",to:"/"},"Home"),">>",s.a.createElement(g.b,{className:"title-text",to:"/CloudInstance"},"\u4e91\u4e3b\u673a\u4fe1\u606f")),s.a.createElement("div",null,s.a.createElement(f.a,{type:"primary",onClick:function(){e.GetClusterInfo()}},"\u7f6e\u7a7a"),s.a.createElement(Re,{placeholder:"\u5b9e\u4f8b\u540d",onSearch:function(t){return e.GetSearchClusterInfo(t)},style:{width:200}}))),s.a.createElement("div",null),s.a.createElement(S.a,{dataSource:this.state.cloud_instance_info,columns:[{title:"\u4e3b\u673a\u540d",dataIndex:"server_hostname",key:"server_hostname"},{title:"\u516c\u7f51ip",colSpan:1,dataIndex:"server_public_ip"},{title:"\u5185\u7f51ip",colSpan:1,dataIndex:"server_private_ip"},{title:"\u7f51\u7edc\u7c7b\u578b",colSpan:1,dataIndex:"network_type"},{title:"\u516c\u7f51\u5e26\u5bbd(Mbps)",colSpan:1,dataIndex:"public_network_bandwidth"},{title:"\u5185\u7f51\u5e26\u5bbd(Mbps)",colSpan:1,dataIndex:"private_network_bandwidth"},{title:"\u5185\u5b58(G)",colSpan:1,dataIndex:"memory"},{title:"\u78c1\u76d8\u5bb9\u91cf(G)",colSpan:1,dataIndex:"disk_capacity"},{title:"\u78c1\u76d8\u7c7b\u578b",colSpan:1,dataIndex:"disk_type"},{title:"cpu(\u6838\u6570)",colSpan:1,dataIndex:"cpu_size"},{title:"\u64cd\u4f5c\u7cfb\u7edf",dataIndex:"server_os"},{title:"\u7c7b\u578b",colSpan:1,dataIndex:"server_type"},{title:"\u7528\u9014",colSpan:1,dataIndex:"server_usage"},{title:"\u662f\u5426\u53ef\u7528",colSpan:1,dataIndex:"status"},{title:"\u5230\u671f\u65f6\u95f4",dataIndex:"deadline"}],bordered:!0,size:"small"}))}}]),t}(n.Component),Ye=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,s=new Array(n),l=0;l<n;l++)s[l]=arguments[l];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).handleLoginSubmit=function(e){e.preventDefault(),a.props.form.validateFields((function(e,t){console.log("Received values of form: ",t),a.login(t.username,t.password)}))},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"login",value:function(e,t){return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:m.a.post("".concat(N,"/auth/"),{username:e,password:t}).then((function(e){console.log(e),window.localStorage.setItem("token",e.data.token),window.location.reload()})).catch((function(e){A.a.error("\u767b\u9646\u5931\u8d25"),console.log(e)}));case 1:case"end":return a.stop()}}))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return s.a.createElement("div",null,s.a.createElement(B.a,{onSubmit:this.handleLoginSubmit,className:"login-form"},s.a.createElement(B.a.Item,null,e("username",{rules:[{required:!0,message:"Please input your username!"}]})(s.a.createElement(k.a,{prefix:s.a.createElement(b.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username"}))),s.a.createElement(B.a.Item,null,e("password",{rules:[{required:!0,message:"Please input your Password!"}]})(s.a.createElement(k.a,{prefix:s.a.createElement(b.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password"}))),s.a.createElement(B.a.Item,null,s.a.createElement(f.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Log in"))))}}]),t}(n.Component),We=B.a.create()(Ye);m.a.defaults.withCredentials=!0,m.a.defaults.headers.post["Content-Type"]="application/json";var Je=k.a.Search,$e=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={mysql_instance_info:[]},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.GetMysqlInstanceInfo()}},{key:"GetMysqlInstanceInfo",value:function(){var e;return v.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a.awrap(m.a.get("".concat(N,"/get_mysql_instance_info/")));case 2:e=t.sent,console.log(e.data),console.log(window&&window.location&&window.location.hostname),this.setState({mysql_instance_info:e.data.data});case 6:case"end":return t.stop()}}),null,this)}},{key:"GetSearchMysqlInstanceInfo",value:function(e){var t;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return this.setState({mysql_instance_info:[]}),a.next=3,v.a.awrap(m.a.post("".concat(N,"/get_search_mysql_instance_info/"),{host_name:e}));case 3:t=a.sent,console.log(t.data),this.setState({mysql_instance_info:t.data.data});case 6:case"end":return a.stop()}}),null,this)}},{key:"render",value:function(){var e=this,t=[{title:"\u4e3b\u673a\u540d",dataIndex:"host_name"},{title:"host_ip",dataIndex:"host_ip"},{title:"port",dataIndex:"port"},{title:"server_charset",dataIndex:"server_charset"},{title:"version",dataIndex:"version"},{title:"bufferpool",dataIndex:"bufferpool"},{title:"instance_status",dataIndex:"instance_status",render:function(e){return s.a.createElement("span",null,"\u6b63\u5e38\u670d\u52a1"===e?s.a.createElement(q.a,{status:"success"}):s.a.createElement(q.a,{status:"error"}),e)}},{title:"read_only",dataIndex:"read_only"},{title:"master_ip",dataIndex:"master_ip"},{title:"master_port",dataIndex:"master_port"}];return s.a.createElement("div",{className:"server-list"},s.a.createElement("div",{className:"sub-title"},s.a.createElement("div",null,s.a.createElement(g.b,{className:"title-text",to:"/"},"Home"),">>",s.a.createElement(g.b,{className:"title-text",to:"/mysqlInstance"},"\u5b9e\u4f8b\u4fe1\u606f")),s.a.createElement("div",null,s.a.createElement(Je,{placeholder:"\u4e3b\u673a\u540d",onSearch:function(t){return e.GetSearchMysqlInstanceInfo(t)},style:{width:200},allowClear:!0}))),s.a.createElement("div",null),s.a.createElement(S.a,{dataSource:this.state.mysql_instance_info,columns:t,bordered:!0,size:"small"}))}}]),t}(n.Component),Xe=p.a.Header,Ze=p.a.Footer,et=p.a.Sider,tt=p.a.Content,at=h.a.SubMenu;function nt(){console.log("\u9000\u51fa\u767b\u9646"),window.localStorage.removeItem("token"),window.location.reload()}m.a.defaults.withCredentials=!0,m.a.defaults.headers.post["Content-Type"]="application/json",m.a.defaults.headers.common.Authorization=window.localStorage.getItem("token");var st=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={login_user_name:"",login_user_name_role:""},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;console.log("Token:",window.localStorage.getItem("token")),D().then((function(t){e.setState({login_user_name:t.data.username,login_user_name_role:t.data.title})})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this;return window.localStorage.getItem("token")?s.a.createElement("div",{className:"App"},s.a.createElement(g.a,null,s.a.createElement(p.a,null,s.a.createElement(Xe,{className:"header"},s.a.createElement("div",{onClick:function(){return window.location.href="/page"}},this.state.login_user_name_role),s.a.createElement("div",null,s.a.createElement("span",null,this.state.login_user_name),s.a.createElement(f.a,{icon:"poweroff",type:"default",style:{marginLeft:5},onClick:nt},"\u6ce8\u9500"))),s.a.createElement(p.a,null,s.a.createElement(et,{width:200,style:{background:"#fff"}},s.a.createElement(h.a,{mode:"inline",defaultSelectedKeys:["1"],defaultOpenKeys:["sub1"],style:{height:"100%"}},s.a.createElement(at,{key:"sub1",title:s.a.createElement("span",null,s.a.createElement(b.a,{type:"cloud-server"}),"server")},s.a.createElement(h.a.Item,{key:"1"},s.a.createElement(g.b,{to:"/Cloud"},"\u4e3b\u673a"))),s.a.createElement(at,{key:"sub2",title:s.a.createElement("span",null,s.a.createElement(b.a,{type:"database"}),"MySQL")},s.a.createElement(h.a.Item,{key:"1"},s.a.createElement(g.b,{to:"#"},"\u4e3b\u673a")),s.a.createElement(h.a.Item,{key:"2"},s.a.createElement(g.b,{to:"/mysqlInstance"},"\u5b9e\u4f8b")),s.a.createElement(h.a.Item,{key:"3"},s.a.createElement(g.b,{to:"/mysqlCluster"},"\u96c6\u7fa4"))),s.a.createElement(at,{key:"sub3",title:s.a.createElement("span",null,s.a.createElement(b.a,{type:"database"}),"Redis")},s.a.createElement(h.a.Item,{key:"1"},s.a.createElement(g.b,{to:"/redisServer"},"\u4e3b\u673a")),s.a.createElement(h.a.Item,{key:"2"},s.a.createElement(g.b,{to:"/redisInstance"},"\u5b9e\u4f8b")),s.a.createElement(h.a.Item,{key:"3"},s.a.createElement(g.b,{to:"/redisCluster"},"\u96c6\u7fa4"))),s.a.createElement(at,{key:"sub4",title:s.a.createElement("span",null,s.a.createElement(b.a,{type:"laptop"}),"\u5de5\u5355")},s.a.createElement(h.a.Item,{key:"1"},s.a.createElement(g.b,{to:"/auditSqlIndex"},"SQL\u5ba1\u6838")),s.a.createElement(h.a.Item,{key:"2"},s.a.createElement(g.b,{to:"/privilegesApply"},"\u6743\u9650\u7533\u8bf7"))),s.a.createElement(at,{key:"sub5",title:s.a.createElement("span",null,s.a.createElement(b.a,{type:"code"}),"\u63a7\u5236\u53f0")},s.a.createElement(h.a.Item,{key:"1"},"MySQL"),s.a.createElement(h.a.Item,{key:"2"},"Redis")),s.a.createElement(at,{key:"sub6",title:s.a.createElement("span",null,s.a.createElement(b.a,{type:"cloud-download"}),"\u6570\u636e\u8fc1\u79fb/\u5bfc\u51fa")},s.a.createElement(h.a.Item,{key:"1"},"\u8fc1\u79fb"),s.a.createElement(h.a.Item,{key:"2"},"\u5bfc\u51fa")),s.a.createElement(at,{key:"sub7",title:s.a.createElement("span",null,s.a.createElement(b.a,{type:"robot"}),"\u81ea\u52a9\u670d\u52a1")},s.a.createElement(h.a.Item,{key:"1"},s.a.createElement(g.b,{to:"/commonUser"},"\u516c\u5171\u8d26\u53f7\u7ba1\u7406")),s.a.createElement(h.a.Item,{key:"2"},"\u5907\u4efd"),s.a.createElement(h.a.Item,{key:"3"},"\u5f52\u6863"),s.a.createElement(h.a.Item,{key:"4"},s.a.createElement(g.b,{to:"/home"},"\u4e3b\u9875"))))),s.a.createElement(tt,null,s.a.createElement(E.a,{exact:!0,path:"/",component:function(){return e.state.is_dba,s.a.createElement(Fe,null)}}),s.a.createElement(E.a,{exact:!0,path:"/Cloud",component:Fe}),s.a.createElement(E.a,{exact:!0,path:"/mysqlCluster",component:U}),s.a.createElement(E.a,{exact:!0,path:"/mysqlInstance",component:$e}),s.a.createElement(E.a,{exact:!0,path:"/publicManage",component:ie}),s.a.createElement(E.a,{exact:!0,path:"/auditSqlIndex",component:W}),s.a.createElement(E.a,{exact:!0,path:"/viewApplySqlByUuid/:submit_sql_uuid",component:se}),s.a.createElement(E.a,{exact:!0,path:"/privilegesApply",component:xe}),s.a.createElement(E.a,{exact:!0,path:"/viewPrivilegeInfoByUuid/:order_uuid",component:Ne}),s.a.createElement(E.a,{exact:!0,path:"/commonUser",component:Ke}),s.a.createElement(E.a,{exact:!0,path:"/home",component:We}))),s.a.createElement(Ze,{style:{textAlign:"center"}},"Devpos Design \xa92020 Created By Me")))):s.a.createElement("div",null,s.a.createElement(p.a,{className:"layout"},s.a.createElement(Xe,{className:"header"},s.a.createElement("span",null,"\u8bf7\u5148\u767b\u9646")),s.a.createElement(tt,{style:{margin:"0 auto",padding:"50px 50px"}},s.a.createElement(We,null)),s.a.createElement(Ze,{style:{textAlign:"center"}},"Devpos Design \xa92020 Created By Me")),",")}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(s.a.createElement(st,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[209,1,2]]]);
//# sourceMappingURL=main.6f75868e.chunk.js.map